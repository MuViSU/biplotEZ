<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>biplotEZ enhancements • biplotEZ</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="biplotEZ enhancements">
<meta property="og:description" content="biplotEZ">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biplotEZ</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/biplotEZ.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/biplotEZ_enhancements.html">biplotEZ enhancements</a>
    </li>
    <li>
      <a href="../articles/Biplots_in_1D.html">Biplots in 1D</a>
    </li>
    <li>
      <a href="../articles/Biplots_in_3D.html">Biplots in 3D</a>
    </li>
    <li>
      <a href="../articles/CA_in_biplotEZ.html">CA in biplotEZ</a>
    </li>
    <li>
      <a href="../articles/Class_separation.html">Class separation</a>
    </li>
    <li>
      <a href="../articles/MDS.html">MDS</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>biplotEZ enhancements</h1>
            
      
      
      <div class="hidden name"><code>biplotEZ_enhancements.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>When enhancing a biplot, various additional features can
significantly improve its interpretability and utility. Introducing
alpha bags helps visualize the central region and variability within a
group, providing a robust measure of data concentration. Adding
confidence ellipses can illustrate the spread and correlation of data
points, making the underlying structure more evident. Including the
capability to add new samples and axes facilitates dynamic exploration
and comparison of data sets. The option to predict samples and means
allows for the projection of data points onto the biplot display, aiding
in predictive analysis. Moreover, tools for reflecting or rotating the
biplot display can enhance the visual representation by aligning the
plot with the user’s analytical needs, offering a clearer perspective on
the relationships and dimensions within the data.</p>
</div>
<div class="section level2">
<h2 id="the-function-alpha-bags">The function <code>alpha.bags()</code><a class="anchor" aria-label="anchor" href="#the-function-alpha-bags"></a>
</h2>
<p>An <span class="math inline">\(\alpha\)</span>-bag encloses the <span class="math inline">\(\alpha100\%\)</span> inner data points in a cloud
of points. It is based on the concept of halfspace location depth as
defined by <span class="citation">Tukey (1975)</span>. <span class="citation">Rousseeuw, Ruts, and Tukey (1999)</span> generalised a
boxplot to a two-dimensional bagplot where the box is replaced by a bag
containing the inner <span class="math inline">\(50\%\)</span> of the
observations. <span class="citation">Gower, Lubbe, and Roux
(2011)</span> replaces the <span class="math inline">\(50\%\)</span>-bag
contour by a general <span class="math inline">\(\alpha100\%\)</span>
contour referred to as an <span class="math inline">\(\alpha\)</span>-bag.</p>
<p>When the number of samples in the biplot is larger, it becomes
difficult to isolate individual observations. Often, when a grouping
variable is present, the interest is not so much in the individual
samples, but rather in the location and spread of the groups. In the
plot below, we enclose each century’s number of sunspots by a <span class="math inline">\(95\%\)</span>-bag where the months are used as 12
different variables for each year (sample point). Note that the legend
displays the <span class="math inline">\(\alpha\)</span>-bags while
<code>samples = FALSE</code> is left at the default. Both can be
displayed, but since the <span class="math inline">\(\alpha\)</span>-bags’ colour defaults to the
colour of the sample points, both are not necessary here.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sunspots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span> <span class="op">(</span><span class="va">sunspot.month</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">264</span><span class="op">*</span><span class="fl">12</span><span class="op">)</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="fl">12</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">1749</span><span class="op">:</span><span class="fl">2012</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">sunspots</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">years</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sunspots</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Jun"</span>,</span>
<span>                        <span class="st">"Jul"</span>, <span class="st">"Aug"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>, <span class="st">"Nov"</span>, <span class="st">"Dec"</span><span class="op">)</span></span>
<span><span class="va">century</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="va">years</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="va">years</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">&lt;</span><span class="fl">21</span>, <span class="st">"th"</span>,<span class="st">"st"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">sunspots</span>, group.aes<span class="op">=</span><span class="va">century</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/axes.html">axes</a></span> <span class="op">(</span>label.dir <span class="op">=</span> <span class="st">"Hor"</span>, label.line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/alpha.bags.html">alpha.bags</a></span> <span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>bags <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 18-th </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 19-th </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 20-th </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 21-st</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>By default one <span class="math inline">\(95\%\)</span>-bag is
constructed for each group. In general, the <code><a href="../reference/alpha.bags.html">alpha.bags()</a></code>
function accepts an object of class biplot as first argument. The next
argument <code>alpha</code> can be specified as a single value, or to
construct a series of <span class="math inline">\(\alpha\)</span>-bags
for a group, <code>alpha</code> can be a vector argument. The argument
<code>which</code> specifies the groups to be fitted with <span class="math inline">\(\alpha\)</span>-bags. By default the
<code>opacity</code> argument is set to <span class="math inline">\(0.25\)</span>, but by setting
<code>opacity = 0</code> removes the fill of the <span class="math inline">\(\alpha\)</span>-bags.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">sunspots</span>, group.aes<span class="op">=</span><span class="va">century</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/axes.html">axes</a></span> <span class="op">(</span>label.dir <span class="op">=</span> <span class="st">"Hor"</span>, label.line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/alpha.bags.html">alpha.bags</a></span> <span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span><span class="op">)</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, opacity <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>bags <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing 0.9 -bag for 18-th </span></span>
<span><span class="co">#&gt; Computing 0.9 -bag for 21-st </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 18-th </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 21-st </span></span>
<span><span class="co">#&gt; Computing 0.99 -bag for 18-th </span></span>
<span><span class="co">#&gt; Computing 0.99 -bag for 21-st</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>In the biplot above, the colours were recycled for each alpha value.
To specify differential colours, we can use the <code>col</code>
argument and similarly the <code>lty</code> and or <code>lwd</code>
arguments. Since we are mostly interested in the location and overlap of
the clouds of points we can remove the indivdiual samples by setting
<code>samples (which = NULL)</code>. The default colours will still be
used for the <span class="math inline">\(\alpha\)</span>-bags and we
chose to specify different line types for different <span class="math inline">\(\alpha\)</span> values. Here the
<code>opacity</code> is set to <span class="math inline">\(0.05\)</span>
which plots a lighter shade inside the <span class="math inline">\(\alpha\)</span>-bags.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">sunspots</span>, group.aes<span class="op">=</span><span class="va">century</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/axes.html">axes</a></span> <span class="op">(</span>label.dir <span class="op">=</span> <span class="st">"Hor"</span>, label.line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>which <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/alpha.bags.html">alpha.bags</a></span> <span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span>, opacity<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>bags <span class="op">=</span> <span class="cn">TRUE</span>, new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing 0.9 -bag for 18-th </span></span>
<span><span class="co">#&gt; Computing 0.9 -bag for 19-th </span></span>
<span><span class="co">#&gt; Computing 0.9 -bag for 20-th </span></span>
<span><span class="co">#&gt; Computing 0.9 -bag for 21-st </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 18-th </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 19-th </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 20-th </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 21-st </span></span>
<span><span class="co">#&gt; Computing 0.99 -bag for 18-th </span></span>
<span><span class="co">#&gt; Computing 0.99 -bag for 19-th </span></span>
<span><span class="co">#&gt; Computing 0.99 -bag for 20-th </span></span>
<span><span class="co">#&gt; Computing 0.99 -bag for 21-st</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-4-1.png" width="672"><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-4-2.png" width="672"></p>
<p>For a completely custom combination of <span class="math inline">\(\alpha\)</span>-bags, we do not rely on any
recycling and specify each of the arguments <code>alpha</code>,
<code>which</code>, <code>col</code>, <code>lty</code>, <code>lwd</code>
as a vector. Since the calculation of halfspace location depth is very
computationally intensive, a random sample of size 2500 is chosen for
each group to construct the <span class="math inline">\(\alpha\)</span>-bag. This sample size can be
changed with the argument <code>max</code>. Setting
<code>trace = FALSE</code> will suppress the message “Computing <span class="math inline">\(\alpha\)</span>” -bag for groupX.”</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">sunspots</span>, group.aes<span class="op">=</span><span class="va">century</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/axes.html">axes</a></span> <span class="op">(</span>label.dir <span class="op">=</span> <span class="st">"Hor"</span>, label.line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>which <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/alpha.bags.html">alpha.bags</a></span> <span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">0.9</span>,   <span class="fl">0.95</span>,   <span class="fl">0.99</span>,             <span class="fl">0.5</span>,         <span class="fl">0.6</span>,     <span class="fl">0.7</span><span class="op">)</span>, </span>
<span>                    which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>     <span class="fl">1</span>,      <span class="fl">1</span>,      <span class="fl">2</span>,               <span class="fl">3</span>,           <span class="fl">3</span>,      <span class="fl">3</span><span class="op">)</span>,</span>
<span>                    col   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"brown"</span>, <span class="st">"red"</span>, <span class="st">"gold"</span>,  <span class="st">"deepskyblue2"</span>, <span class="st">"steelblue3"</span>,<span class="st">"blue"</span><span class="op">)</span>,</span>
<span>                    lty   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>     <span class="fl">1</span>,      <span class="fl">2</span>,     <span class="fl">10</span>,               <span class="fl">2</span>,           <span class="fl">2</span>,      <span class="fl">0</span><span class="op">)</span>,</span>
<span>                    lwd   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>     <span class="fl">1</span>,      <span class="fl">1</span>,      <span class="fl">3</span>,               <span class="fl">1</span>,           <span class="fl">2</span>,      <span class="fl">1</span><span class="op">)</span>,</span>
<span>                    opacity <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing 0.9 -bag for 18-th </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 18-th </span></span>
<span><span class="co">#&gt; Computing 0.99 -bag for 19-th </span></span>
<span><span class="co">#&gt; Computing 0.5 -bag for 20-th </span></span>
<span><span class="co">#&gt; Computing 0.6 -bag for 20-th </span></span>
<span><span class="co">#&gt; Computing 0.7 -bag for 20-th</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>The function <code>alpha.bags</code> provides the option to only plot
the samples that sit outside the <span class="math inline">\(\alpha\)</span>-bags. This is done by setting the
argument <code>outlying=TRUE</code>. Note the <code>which</code>
argument may be overwritten when <code>outlying</code> is set to
<code>TRUE</code>. This happens in particular when <code>which</code> in
the <code><a href="../reference/samples.html">samples()</a></code> function differs from the <code>which</code>
in the <code>alpha_bags()</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">sunspots</span>, group.aes<span class="op">=</span><span class="va">century</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/alpha.bags.html">alpha.bags</a></span> <span class="op">(</span>col   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"brown"</span>, <span class="st">"red"</span>, <span class="st">"gold"</span>,<span class="st">"deepskyblue2"</span><span class="op">)</span>,</span>
<span>                    opacity <span class="op">=</span> <span class="fl">0.1</span>,outlying <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 18-th </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 19-th </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 20-th </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for 21-st</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="the-function-ellipses">The function <code>ellipses()</code><a class="anchor" aria-label="anchor" href="#the-function-ellipses"></a>
</h2>
<p>If we observe a random sample from a <span class="math inline">\(p\)</span>-variate normal distribution with <span class="math inline">\(\bar{\mathbf{x}}\)</span> and <span class="math inline">\(\mathbf{S}\)</span> the usual unbaised estimates
of the mean vector and covariance matrix, then</p>
<p><span class="math display">\[
(\mathbf{x} - \bar{\mathbf{x}})' \mathbf{S}^{-1} (\mathbf{x} -
\bar{\mathbf{x}}) = \kappa^2
\]</span></p>
<p>traces an ellipsoid in <span class="math inline">\(p\)</span>
dimensions. For <span class="math inline">\(p=2\)</span>, choosing <span class="math inline">\(\kappa =
{(\chi^{2}_{2,1-\alpha})}^{\frac{1}{2}}\)</span> where <span class="math inline">\(\chi^{2}_{2,1-\alpha}\)</span> denotes the <span class="math inline">\((1-\alpha)100\)</span>-th percentage point of the
<span class="math inline">\(\chi^2_2\)</span> distribution results in an
ellipse covering approximately <span class="math inline">\(100\alpha\%\)</span> of the configuration of
two-dimensional points. With default arguments <code>df = 2</code> and
<code>alpha = 0.95</code>, the value of <span class="math inline">\(\kappa\)</span> is <span class="math inline">\(2.447747\)</span> and the ellipse function
constructs an ellipse that would enclose approximately <span class="math inline">\(95\%\)</span> of the observations from a bivariate
normal distribution. The argument <code>kappa</code> can be specified
directly, and will take precedence over the specification of
<code>alpha</code>. The other arguments of the <code><a href="../reference/ellipses.html">ellipses()</a></code>
function operates identically to the corresponding arguments of the
function <code><a href="../reference/alpha.bags.html">alpha.bags()</a></code>. Using <span class="math inline">\(\alpha\)</span>-bags, rather than ellipses is
recommended in general, since the construction of the ellipses are based
on the underlying assumption of a random sample observed from a normal
distribution.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">sunspots</span>, group.aes<span class="op">=</span><span class="va">century</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/axes.html">axes</a></span> <span class="op">(</span>label.dir <span class="op">=</span> <span class="st">"Hor"</span>, label.line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>which <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/ellipses.html">ellipses</a></span> <span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.95</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span>, opacity <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>ellipses <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing 2.15 -ellipse for 18-th </span></span>
<span><span class="co">#&gt; Computing 2.15 -ellipse for 19-th </span></span>
<span><span class="co">#&gt; Computing 2.15 -ellipse for 20-th </span></span>
<span><span class="co">#&gt; Computing 2.15 -ellipse for 21-st </span></span>
<span><span class="co">#&gt; Computing 2.45 -ellipse for 18-th </span></span>
<span><span class="co">#&gt; Computing 2.45 -ellipse for 19-th </span></span>
<span><span class="co">#&gt; Computing 2.45 -ellipse for 20-th </span></span>
<span><span class="co">#&gt; Computing 2.45 -ellipse for 21-st</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">sunspots</span>, group.aes<span class="op">=</span><span class="va">century</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/axes.html">axes</a></span> <span class="op">(</span>label.dir <span class="op">=</span> <span class="st">"Hor"</span>, label.line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>which <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="../reference/ellipses.html">ellipses</a></span> <span class="op">(</span>kappa <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span>, opacity <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>ellipses <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing 1 -ellipse for 18-th </span></span>
<span><span class="co">#&gt; Computing 1 -ellipse for 19-th </span></span>
<span><span class="co">#&gt; Computing 1 -ellipse for 20-th </span></span>
<span><span class="co">#&gt; Computing 1 -ellipse for 21-st </span></span>
<span><span class="co">#&gt; Computing 2 -ellipse for 18-th </span></span>
<span><span class="co">#&gt; Computing 2 -ellipse for 19-th </span></span>
<span><span class="co">#&gt; Computing 2 -ellipse for 20-th </span></span>
<span><span class="co">#&gt; Computing 2 -ellipse for 21-st</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-7-2.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="the-function-density2d">The function <code>density2D()</code><a class="anchor" aria-label="anchor" href="#the-function-density2d"></a>
</h2>
<p>This is a function for constructing two-dimensional PCA biplots on
top of a density plot of a two-dimensional PCA approximation of the
input matrix. The R function <code>kde2d</code> described by <span class="citation">Venables and Ripley (2002)</span> and available in the
package <code>MASS</code> is used to perform two-dimensional kernel
density estimation with an axis-aligned bivariate normal kernel,
evaluated on a square grid.</p>
<p>The function plots the density for each group (specified in the
argument <code>which</code>) in the data. In the following case, the
second group’s density is plotted with <code>contours=TRUE</code>. A
vector of at least two components should be specified in the
<code>col</code> argument to display the colours of the density response
surface. There are <code>cuts</code>-1 colours interpolated between the
components of the <code>col</code>. The default is
<code>c("green", "yellow", "red")</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>,group.aes <span class="op">=</span> <span class="va">state.region</span>,scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/density2D.html">density2D</a></span><span class="op">(</span>which<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>,<span class="st">"purple"</span>,<span class="st">"blue"</span>,<span class="st">"cyan"</span><span class="op">)</span>,contours<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>In this case, the vector <code>group.aes</code> is not specified, so
all samples form under one group.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>,scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/samples.html">samples</a></span><span class="op">(</span>which<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/density2D.html">density2D</a></span><span class="op">(</span>which<span class="op">=</span><span class="fl">1</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>,<span class="st">"purple"</span>,<span class="st">"blue"</span>,<span class="st">"cyan"</span><span class="op">)</span>,contours <span class="op">=</span> <span class="cn">TRUE</span>,cuts <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="the-functions-interpolate-with-newsamples-and-newaxes">The functions <code>interpolate()</code> with
<code>newsamples()</code> and <code>newaxes()</code><a class="anchor" aria-label="anchor" href="#the-functions-interpolate-with-newsamples-and-newaxes"></a>
</h2>
<p>The process of interpolation is described by <span class="citation">Gower and Hand (1996)</span> as the process of finding
the coordinates of a <span class="math inline">\(p\)</span>-dimensional
sample in the lower dimensional biplot space. For PCA we showed in
section 1 in the biplotEZ vignette that the sample points are
represented by <span class="math inline">\(\mathbf{G}=\mathbf{UDJ}_2\)</span> which can be
written as <span class="math inline">\(\mathbf{G}=\mathbf{UDV'VJ}_2=\mathbf{XVJ}_2\)</span>.
Finding the position of a new sample <span class="math inline">\(\mathbf{x}^*:p \times 1\)</span> make use of the
same transformation so that the 2D coordinates is given by <span class="math inline">\({\mathbf{z}^*}':2 \times 1
={\mathbf{x}^*}' \mathbf{VJ}_2\)</span>. Similarly, the position of
a new variable <span class="math inline">\(\mathbf{x}^*:n \times
1\)</span> is added using a regression method that assumes that <span class="math inline">\(\mathbf{x}^*\)</span> is approximately a linear
function <span class="math inline">\(\mathbf{x}^* =
\mathbf{XV}_r\mathbf{b}_r\)</span> with solution <span class="math inline">\(\hat{\mathbf{b}}_r :r \times 1 =
(\mathbf{V}'_r\mathbf{X}'\mathbf{XV}_r)^{-1}\mathbf{V}_r\mathbf{X}'\mathbf{x}^*\)</span>.</p>
<p>Adding samples and variables to the plot is facilitated by the
function <code><a href="../reference/interpolate.html">interpolate()</a></code>. Note that the samples and variables
to be interpolated did not contribute to the construction of the biplot.
This is the reason why <span class="citation">Greenacre (2017)</span>
term these supplementary points or axes.</p>
<p>The function <code><a href="../reference/interpolate.html">interpolate()</a></code> accepts a matrix or data
frame containing the samples and variables to be interpolated. The
argument <code>newdata</code> containing the samples to be interpolated
needs to have a similar structure to the data set sent to
<code><a href="../reference/biplot.html">biplot()</a></code>. If <code><a href="../reference/biplot.html">biplot()</a></code> received a data frame,
<code>newdata</code> can be either another data frame or a matrix
containing the subset of numerical variables. Similarly, the argument
<code>newvariable</code> containing the new variables to be interpolated
needs to have the same number of samples in the data sent to
<code><a href="../reference/biplot.html">biplot()</a></code>.</p>
<p>Suppose we construct a PCA biplot of the first <span class="math inline">\(40\)</span> samples in the data set
<code>rock</code> and then <span class="math inline">\(8\)</span> new
samples is to be interpolated the call will be:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">rock</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>,<span class="op">]</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/interpolate.html">interpolate</a></span> <span class="op">(</span>newdata<span class="op">=</span><span class="va">rock</span><span class="op">[</span><span class="fl">41</span><span class="op">:</span><span class="fl">48</span>,<span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>The function <code><a href="../reference/newsamples.html">newsamples()</a></code> operates similar to samples,
allowing changes to the aesthetics of the interpolated new samples.
There is no argument <code>which</code> for <code><a href="../reference/newsamples.html">newsamples()</a></code>
since it is assumed that samples are interpolated to be represented in
the biplot. All the other arguments are vectors of length similar to the
number of samples in <code>newdata</code>. To change the colour of the
interpolated samples and add labels, the following call will be
used:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">rock</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>,<span class="op">]</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/interpolate.html">interpolate</a></span> <span class="op">(</span><span class="va">rock</span><span class="op">[</span><span class="fl">41</span><span class="op">:</span><span class="fl">48</span>,<span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/newsamples.html">newsamples</a></span> <span class="op">(</span>label <span class="op">=</span> <span class="cn">TRUE</span>, label.side <span class="op">=</span> <span class="st">"top"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>Suppose constructing a PCA biplot using the three variables in the
<code>rock</code> data, and interpolating the other variable.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">rock</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/interpolate.html">interpolate</a></span> <span class="op">(</span>newvariable <span class="op">=</span><span class="va">rock</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>We can change the aesthetics of the new variables with the
<code><a href="../reference/newaxes.html">newaxes()</a></code> function which operates similarly to the
<code><a href="../reference/axes.html">axes()</a></code> function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">rock</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/interpolate.html">interpolate</a></span> <span class="op">(</span>newvariable <span class="op">=</span><span class="va">rock</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/newaxes.html">newaxes</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"red"</span>,ticks <span class="op">=</span> <span class="fl">50</span>,X.new.names <span class="op">=</span> <span class="st">"shape"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>The function <code><a href="../reference/interpolate.html">interpolate()</a></code> will also work if new samples
and new variables need to be interpolated at the same time. For
example:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">rock</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/interpolate.html">interpolate</a></span> <span class="op">(</span>newdata<span class="op">=</span><span class="va">rock</span><span class="op">[</span><span class="fl">41</span><span class="op">:</span><span class="fl">48</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,newvariable <span class="op">=</span><span class="va">rock</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/newaxes.html">newaxes</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"red"</span>,ticks <span class="op">=</span> <span class="fl">100</span>,X.new.names <span class="op">=</span> <span class="st">"shape"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<p>Notice that <code>newdata</code> has the same number of variables as
the data sent to <code><a href="../reference/biplot.html">biplot()</a></code> and <code>newvariable</code> has
the same number of samples as the data sent to
<code><a href="../reference/biplot.html">biplot()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="the-function-prediction">The function <code>prediction()</code><a class="anchor" aria-label="anchor" href="#the-function-prediction"></a>
</h2>
<p>To add prediction of the sample points to the biplot, the function
<code><a href="../reference/prediction.html">prediction()</a></code> is used.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">rock</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>         <span class="fu"><a href="../reference/prediction.html">prediction</a></span> <span class="op">(</span>predict.samples <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<p>In addition the predictions are computed and can be accessed with the
<code>summary.method</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 48 samples and 4 variables.</span></span>
<span><span class="co">#&gt; 4 numeric variables.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample predictions</span></span>
<span><span class="co">#&gt;         area      peri      shape        perm</span></span>
<span><span class="co">#&gt; 1   5182.518 2694.6678 0.08624348   17.426253</span></span>
<span><span class="co">#&gt; 2   7691.949 3526.4942 0.13514234   35.517473</span></span>
<span><span class="co">#&gt; 3   8318.033 3628.6997 0.16177613   99.694598</span></span>
<span><span class="co">#&gt; 4   7636.831 3630.8908 0.11725845  -34.364599</span></span>
<span><span class="co">#&gt; 5   8084.856 3781.5005 0.12570117  -32.323140</span></span>
<span><span class="co">#&gt; 6   8499.105 3765.0371 0.15484655   57.771249</span></span>
<span><span class="co">#&gt; 7   9738.891 4180.1532 0.17843607   64.357324</span></span>
<span><span class="co">#&gt; 8   8877.364 3954.7565 0.15340118   24.056153</span></span>
<span><span class="co">#&gt; 9   8718.501 3605.5323 0.19094566  190.899483</span></span>
<span><span class="co">#&gt; 10  6776.004 2972.9886 0.15153800  170.463202</span></span>
<span><span class="co">#&gt; 11  9517.287 4203.7977 0.16081144    7.756551</span></span>
<span><span class="co">#&gt; 12  8667.626 3841.4265 0.15531722   47.357938</span></span>
<span><span class="co">#&gt; 13 10542.328 4258.1501 0.21989947  176.826997</span></span>
<span><span class="co">#&gt; 14  9102.060 3644.4083 0.21051537  243.662966</span></span>
<span><span class="co">#&gt; 15  9351.922 4027.1591 0.17428339   75.571235</span></span>
<span><span class="co">#&gt; 16  8590.817 3776.8963 0.15917449   68.935190</span></span>
<span><span class="co">#&gt; 17 11002.857 4604.0870 0.20238688   70.663421</span></span>
<span><span class="co">#&gt; 18 11465.727 4562.1556 0.23817832  184.664030</span></span>
<span><span class="co">#&gt; 19 11713.492 4918.0115 0.20549573   31.397809</span></span>
<span><span class="co">#&gt; 20  9794.836 4371.1960 0.15588772  -32.950729</span></span>
<span><span class="co">#&gt; 21  7486.756 3459.7842 0.13096481   33.297702</span></span>
<span><span class="co">#&gt; 22 11970.162 4545.5777 0.27319335  292.407085</span></span>
<span><span class="co">#&gt; 23 12048.397 4816.3066 0.24117196  154.306887</span></span>
<span><span class="co">#&gt; 24  8161.391 3531.7628 0.16489230  124.063184</span></span>
<span><span class="co">#&gt; 25  6473.046 1887.1108 0.28067750  726.488443</span></span>
<span><span class="co">#&gt; 26  3937.319 1270.4047 0.20059243  581.415341</span></span>
<span><span class="co">#&gt; 27  6361.245 2198.9634 0.23068527  528.041307</span></span>
<span><span class="co">#&gt; 28  4364.754 1641.8821 0.17743170  454.331807</span></span>
<span><span class="co">#&gt; 29  5961.529 1813.4043 0.25757496  668.505918</span></span>
<span><span class="co">#&gt; 30  5419.192 1075.2405 0.32352672  980.895692</span></span>
<span><span class="co">#&gt; 31  6687.830 1728.1793 0.31639877  858.392956</span></span>
<span><span class="co">#&gt; 32  6862.484 1912.2039 0.30251759  788.205529</span></span>
<span><span class="co">#&gt; 33  5072.364 1506.6448 0.24189571  668.903853</span></span>
<span><span class="co">#&gt; 34  5330.680 1039.1725 0.32272399  984.068789</span></span>
<span><span class="co">#&gt; 35  5510.961 1842.2520 0.22437503  564.315264</span></span>
<span><span class="co">#&gt; 36  6834.394 1864.9721 0.30716675  809.483177</span></span>
<span><span class="co">#&gt; 37  3788.048 1612.7808 0.14398515  358.372419</span></span>
<span><span class="co">#&gt; 38  3912.089  510.0085 0.30315670 1007.222092</span></span>
<span><span class="co">#&gt; 39  3569.066 1564.6150 0.13637128  342.959576</span></span>
<span><span class="co">#&gt; 40  5655.233 2040.8001 0.20653151  479.977300</span></span>
<span><span class="co">#&gt; 41  4984.153  680.9452 0.34932075 1119.421832</span></span>
<span><span class="co">#&gt; 42  1341.442 -373.1439 0.25731781 1006.268880</span></span>
<span><span class="co">#&gt; 43  6519.731  738.7171 0.44107961 1386.097805</span></span>
<span><span class="co">#&gt; 44  8964.500 1961.9907 0.43213873 1169.846628</span></span>
<span><span class="co">#&gt; 45  3589.848 1128.4355 0.19749274  594.085244</span></span>
<span><span class="co">#&gt; 46  2533.721  417.0546 0.22642373  791.127217</span></span>
<span><span class="co">#&gt; 47  4876.168 1721.4564 0.19972344  508.970410</span></span>
<span><span class="co">#&gt; 48  7521.495 2660.6426 0.24273124  492.744256</span></span></code></pre></div>
<p>The other arguments to <code><a href="../reference/prediction.html">prediction()</a></code> are
<code>predict.means</code> to also (or only) predict the group means and
<code>which</code> to indicate which axes’ predictions are shown on the
biplot. By specifying <code>predict.samples = TRUE</code> and/or
<code>predict.means = TRUE</code> all samples and/or means are
predicted. Alternatively either of these arguments accepts a vector
indicating which samples and/or means to predict. In the example below,
only the mean values of the Central and West regions are predicted.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span>group.aes <span class="op">=</span> <span class="va">state.region</span>, show.class.means <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>         <span class="fu"><a href="../reference/prediction.html">prediction</a></span> <span class="op">(</span>predict.means <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Income"</span>,<span class="st">"Murder"</span>,<span class="st">"Population"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 50 samples and 8 variables.</span></span>
<span><span class="co">#&gt; 8 numeric variables.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Class mean predictions</span></span>
<span><span class="co">#&gt;                 Income   Murder Population</span></span>
<span><span class="co">#&gt; North Central 4611.672 5.108174   3211.604</span></span>
<span><span class="co">#&gt; West          4862.927 6.865661   5268.183</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-functions-reflect-and-rotate">The functions <code>reflect()</code> and <code>rotate()</code><a class="anchor" aria-label="anchor" href="#the-functions-reflect-and-rotate"></a>
</h2>
<p>The function <code><a href="../reference/reflect.html">reflect()</a></code> allows for the user to reflect
the biplot display about the x-axis or y-axis or both. The argument
<code>reflect.axis</code> offers the options
<code>"FALSE"</code>,<code>"x"</code>,<code>"y"</code>,<code>"xy"</code>.</p>
<p>Here the biplot is reflected about the x-axis.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span>group.aes <span class="op">=</span> <span class="va">state.division</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/reflect.html">reflect</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
<p>Here the biplot is reflected about the y-axis.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span>group.aes <span class="op">=</span> <span class="va">state.division</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/reflect.html">reflect</a></span><span class="op">(</span><span class="st">"y"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
<p>The function <code><a href="../reference/rotate.html">rotate()</a></code> allows for the user to rotate the
biplot display by a certain value of degrees. The default is 0 and
positive value results in anti-clockwise rotation and negative value in
clockwise rotation. For example when <code>rotate.degrees</code> is set
to 100 degrees, then the biplot is rotated by 100 degrees in the
anticlockwise direction.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span>group.aes <span class="op">=</span> <span class="va">state.division</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/rotate.html">rotate</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="zooming-in-on-the-biplot-with-zoom-true-in-plot">Zooming in on the biplot with <code>zoom = TRUE</code> in
<code>plot()</code><a class="anchor" aria-label="anchor" href="#zooming-in-on-the-biplot-with-zoom-true-in-plot"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function has built-in functionality to zoom
in on the plot. This is done through the <code><a href="https://rdrr.io/r/graphics/locator.html" class="external-link">locator()</a></code> function
which alters the <code>xlim</code> and <code>ylim</code> paramaters of
the plot. The implementation opens up a new graphics window before
promting the locator function. It is illustrated below:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>,scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/samples.html">samples</a></span><span class="op">(</span>which<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/density2D.html">density2D</a></span><span class="op">(</span>which<span class="op">=</span><span class="fl">1</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>,<span class="st">"purple"</span>,<span class="st">"blue"</span>,<span class="st">"cyan"</span><span class="op">)</span>,contours <span class="op">=</span> <span class="cn">TRUE</span>,cuts <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>zoom<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-22-1.png" width="672">
With the final plot then rendered as:</p>
<p><img src="biplotEZ_enhancements_files/figure-html/unnamed-chunk-23-1.png" width="672"></p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-GowerHand1996" class="csl-entry">
Gower, J. C., and D. J. Hand. 1996. <em>Biplots.</em> Chapman &amp;
Hall.
</div>
<div id="ref-UB2011" class="csl-entry">
Gower, J. C., S. Lubbe, and N. J. le Roux. 2011. <em>Understanding
Biplots.</em> Wiley.
</div>
<div id="ref-Greenacre2017" class="csl-entry">
Greenacre, M. J. 2017. <em>Correspondence Analysis in Practice.</em> CRC
press.
</div>
<div id="ref-RousseeuwRutsTukey1999" class="csl-entry">
Rousseeuw, P. J, I Ruts, and J. W. Tukey. 1999. <span>“The Bagplot: A
Bivaraite Boxplot.”</span> <em>American Statistician</em>, 382–87.
</div>
<div id="ref-Tukey1975" class="csl-entry">
Tukey, J. W. 1975. <span>“Mathematics and the Picturing of Data.”</span>
<em>Proceedings of the International Congress of Mathematicians</em>,
523–31.
</div>
<div id="ref-Venables2002" class="csl-entry">
Venables, W. N., and B. D Ripley. 2002. <em>Modern Applied Statistics
with s (4th Edition).</em> New York: Springer.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sugnet Lubbe, Niël le Roux, Johané Nienkemper-Swanepoel, Raeesa Ganey, Ruan Buys, Zoë-Mae Adams, Peter Manefeldt.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
