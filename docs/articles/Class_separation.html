<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Class separation • biplotEZ</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Class separation">
<meta property="og:description" content="biplotEZ">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biplotEZ</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/biplotEZ.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/biplotEZ_enhancements.html">biplotEZ enhancements</a>
    </li>
    <li>
      <a href="../articles/Biplots_in_1D.html">Biplots in 1D</a>
    </li>
    <li>
      <a href="../articles/Biplots_in_3D.html">Biplots in 3D</a>
    </li>
    <li>
      <a href="../articles/CA_in_biplotEZ.html">CA in biplotEZ</a>
    </li>
    <li>
      <a href="../articles/Class_separation.html">Class separation</a>
    </li>
    <li>
      <a href="../articles/MDS.html">MDS</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Class separation</h1>
            
      
      
      <div class="hidden name"><code>Class_separation.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">biplotEZ</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'biplotEZ'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     biplot</span></span></code></pre></div>
<p>This vignette deals with biplots for separating classes. Topics
discussed are</p>
<ul>
<li>CVA (Canonical variate analysis) biplots</li>
<li>AoD (Analysis of Distance) biplots</li>
<li>Classification biplots</li>
</ul>
<div class="section level2">
<h2 id="what-is-a-cva-biplot">What is a CVA biplot<a class="anchor" aria-label="anchor" href="#what-is-a-cva-biplot"></a>
</h2>
<p>Consider a data matrix <span class="math inline">\(\mathbf{X}:n
\times p\)</span> containing data on <span class="math inline">\(n\)</span> objects and <span class="math inline">\(p\)</span> variables. In addition, a vector <span class="math inline">\(\mathbf{g}:n \times 1\)</span> contains
information on class membership of each observation. Let <span class="math inline">\(G\)</span> indicate the total number of classes.
CVA is closely related to linear discriminant anlaysis, in that the
<span class="math inline">\(p\)</span> variables are transformed to
<span class="math inline">\(p\)</span> new variables, called canonical
variates, such that the classes are optimally separated in the canonical
space. By optimally separated, we mean maximising the between class
variance, relative to the within class variance. This can be formulated
as follows:</p>
<p>Let <span class="math inline">\(\mathbf{G}:n \times G\)</span> be an
indicator matrix with <span class="math inline">\(g_{ij} = 0\)</span>
unless observation <span class="math inline">\(i\)</span> belongs to
class <span class="math inline">\(j\)</span> and then <span class="math inline">\(g_{ij} = 1\)</span>. The matrix <span class="math inline">\(\mathbf{G'G}\)</span> is a diagonal matrix
containing the number of observations per class on the diagonal. We can
form the matrix of class means <span class="math inline">\(\bar{\mathbf{X}}:G \times p =
(\mathbf{G'G})^{-1} \mathbf{G'X}\)</span>. With the usual
analysis of variance the total variance can be decomposed into a between
class variance and within class variance:</p>
<p><span class="math display">\[
\mathbf{T} = \mathbf{B} + \mathbf{W}
\]</span></p>
<p><span class="math display">\[
\mathbf{X'X} = \mathbf{\bar{\mathbf{X}}'C \bar{\mathbf{X}}} +
\mathbf{X' [I - G(G'G)^{-1}C(G'G)^{-1}G'] X}
\]</span></p>
<p>The default choice for the centring matrix <span class="math inline">\(\mathbf{C = G'G}\)</span> leads to the
simplification</p>
<p><span class="math display">\[
\mathbf{X'X} = \mathbf{\bar{\mathbf{X}}'G'G
\bar{\mathbf{X}}} + \mathbf{X' [I - G(G'G)^{-1}G'] X}.
\]</span></p>
<p>Other options are <span class="math inline">\(\mathbf{C = I}\)</span>
and <span class="math inline">\(\mathbf{C} = (\mathbf{I}_G -
\frac{1}{G}\mathbf{11'})\)</span>. To find the canonical variates we
want to maximise the ratio</p>
<p><span class="math display">\[
\frac{\mathbf{m'Bm}}{\mathbf{m'Wm}}
\]</span></p>
<p>subject to <span class="math inline">\(\mathbf{m'Wm} =
1\)</span>. It can be shown that this leads to the following equivalent
eigen equations:</p>
<p><span class="math display">\[
\mathbf{W}^{-1}\mathbf{BM} = \mathbf{M \Lambda} \tag{1}
\]</span></p>
<p><span class="math display">\[
\mathbf{BM} = \mathbf{WM \Lambda}
\]</span></p>
<p><span class="math display">\[
(\mathbf{W}^{-\frac{1}{2}} \mathbf{B} \mathbf{W}^{-\frac{1}{2}})
\mathbf{M} = (\mathbf{W}^{-\frac{1}{2}} \mathbf{M}) \mathbf{\Lambda}
\]</span></p>
<p>with <span class="math inline">\(\mathbf{M'BM}=
\mathbf{\Lambda}\)</span> and <span class="math inline">\(\mathbf{M'WM}= \mathbf{I}\)</span>.</p>
<p>Since the matrix <span class="math inline">\(\mathbf{W}^{-\frac{1}{2}} \mathbf{B}
\mathbf{W}^{-\frac{1}{2}}\)</span> is symmetric and positive
semi-definite the eigenvalues in the matrix <span class="math inline">\(\mathbf{\Lambda}\)</span> are positive and
ordered. The rank of <span class="math inline">\(\mathbf{B} = min(p,
G-1)\)</span> so that only the first <span class="math inline">\(rank(\mathbf{B})\)</span> eigenvalues are
non-zero. We form the canonical variates with the transformation</p>
<p><span class="math display">\[
\bar{\mathbf{Y}} = \bar{\mathbf{X}}\mathbf{M}.
\]</span></p>
<p>To construct a 2D biplot, we plot the first two canonical variates
<span class="math inline">\(\bar{\mathbf{Z}} =
\bar{\mathbf{X}}\mathbf{MJ}_2\)</span> where <span class="math inline">\(\mathbf{J}_2' = \begin{bmatrix} \mathbf{I}_2
&amp; \mathbf{0} \end{bmatrix}\)</span>. We add the individual sample
points with the same transformation</p>
<p><span class="math display">\[
\mathbf{Z} = \mathbf{X}\mathbf{MJ}_2
\]</span> where <span class="math display">\[
\mathbf{J}_2 = \begin{bmatrix}
                \mathbf{I}_2\\
                \mathbf{0}
               \end{bmatrix}.
\]</span> Interpolation of a new sample <span class="math inline">\(\mathbf{x}^*:p \times 1\)</span> follows as <span class="math inline">\({\mathbf{z}^*}':2 \times 1
={\mathbf{x}^*}' \mathbf{MJ}_2\)</span>. Using the inverse
transformation <span class="math inline">\(\mathbf{x}' =
\mathbf{y}'\mathbf{M}^{-1}\)</span>, all the points that will
predict <span class="math inline">\(\mu\)</span> for variable <span class="math inline">\(j\)</span> will have the form</p>
<p><span class="math display">\[
\mu = \mathbf{y}'\mathbf{M}^{-1} \mathbf{e}_j
\]</span></p>
<p>where <span class="math inline">\(\mathbf{e}_j\)</span> is a vector
of zeros with a one in position <span class="math inline">\(j\)</span>.
All the points in the 2D biplot that predict the value <span class="math inline">\(\mu\)</span> will have</p>
<p><span class="math display">\[
\mu = \begin{bmatrix} z_1 &amp; z_2 &amp; 0 &amp; \dots &amp;
0\end{bmatrix}\mathbf{M}^{-1} \mathbf{e}_j
\]</span></p>
<p>defining the prediction line as</p>
<p><span class="math display">\[
\mu = \mathbf{z}_{\mu}' \mathbf{J}_2 \mathbf{M}^{-1} \mathbf{e}_j.
\]</span></p>
<p>Writing <span class="math inline">\(\mathbf{h}_{(j)} = \mathbf{J}_2
\mathbf{M}^{-1} \mathbf{e}_j\)</span> the construction of biplot axes is
similar to the discussion in the biplotEZ vignette for PCA biplots. The
direction of the axis is given by <span class="math inline">\(\mathbf{h}_{(j)}\)</span>. To find the
intersection of the prediction line with <span class="math inline">\(\mathbf{h}_{(j)}\)</span> we note that <span class="math display">\[
\mathbf{z}'_{(\mu)}\mathbf{h}_{(j)} = \| \mathbf{z}_{(\mu)} \|^2 \|
\mathbf{h}_{(j)} \|^2 cos(\mathbf{z}_{(\mu)},\mathbf{h}_{(j)}) =
\| \mathbf{p} \|^2 \| \mathbf{h}_{(j)} \|^2
\]</span> where <span class="math inline">\(\mathbf{p}\)</span> is the
length of the orthogonal projection of <span class="math inline">\(\mathbf{z}_{(\mu)}\)</span> on <span class="math inline">\(\mathbf{h}_{(j)}\)</span>.</p>
<p>Since <span class="math inline">\(\mathbf{p}\)</span> is along <span class="math inline">\(\mathbf{h}_{(j)}\)</span> we can write <span class="math inline">\(\mathbf{p} = c\mathbf{h}_{(j)}\)</span> and all
points on the prediction line <span class="math inline">\(\mu =
\mathbf{z}'_{\mu}\mathbf{h}_{(j)}\)</span> project on the same point
<span class="math inline">\(c_{\mu}\mathbf{h}_{(j)}\)</span>. We solve
for <span class="math inline">\(c_{\mu}\)</span> from <span class="math display">\[
\mu = \mathbf{z}'_{\mu}\mathbf{h}_{(j)}=\| \mathbf{p} \|^2 \|
\mathbf{h}_{(j)} \|^2 =
\| c_{\mu}\mathbf{h}_{(j)} \|^2 \| \mathbf{h}_{(j)} \|^2
\]</span></p>
<p><span class="math display">\[
c_{\mu} = \frac{\mu}{\mathbf{h}_{(j)}'\mathbf{h}_{(j)}}.
\]</span> If we select ‘nice’ scale markers <span class="math inline">\(\tau_{1}, \tau_{2}, \cdots \tau_{k}\)</span> for
variable <span class="math inline">\(j\)</span>, then <span class="math inline">\(\tau_{h}-\bar{x}_j = \mu_{h}\)</span> and
positions of these scale markers on <span class="math inline">\(\mathbf{h}_{(j)}\)</span> are given by <span class="math inline">\(p_{\mu_{1}}, p_{\mu_{2}}, \cdots
p_{\mu_{k}}\)</span> with <span class="math display">\[
p_{\mu_h} = c_{\mu_h}\mathbf{h}_{(j)}
=  \frac{\mu_h}{\mathbf{h}_{(j)}'\mathbf{h}_{(j)}}\mathbf{h}_{(j)}
\]</span></p>
<p><span class="math display">\[
= \frac{\mu_h}{\mathbf{e}_{(j)}' \mathbf{M'}^{-1} \mathbf{J}
\mathbf{M}^{-1} \mathbf{e}_{(j)}}\ \mathbf{J}_2 \mathbf{M}^{-1}
\mathbf{e}_{(j)}
\]</span></p>
<p>with <span class="math display">\[
\mathbf{J} = \begin{bmatrix}
              \mathbf{I}_2 &amp; \mathbf{0}\\
              \mathbf{0} &amp; \mathbf{0}
             \end{bmatrix}.
\]</span></p>
</div>
<div class="section level2">
<h2 id="the-function-cva">The function <code>CVA()</code><a class="anchor" aria-label="anchor" href="#the-function-cva"></a>
</h2>
<p>To obtain a CVA biplot of the <code>state.x77</code> data set,
optimally separating the classes according to <code>state.region</code>
we call</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/CVA.html">CVA</a></span><span class="op">(</span>classes <span class="op">=</span> <span class="va">state.region</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Class_separation_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>Fitting <span class="math inline">\(\alpha\)</span>-bags to the
classes makes it easier to compare class overlap and separation. For a
detailed discussion on <span class="math inline">\(\alpha\)</span>-bags,
see the <em>biplotEZ</em> vignette.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/CVA.html">CVA</a></span><span class="op">(</span>classes <span class="op">=</span> <span class="va">state.region</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/alpha.bags.html">alpha.bags</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span> <span class="op">(</span>bags <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for Northeast </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for South </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for North Central </span></span>
<span><span class="co">#&gt; Computing 0.95 -bag for West</span></span></code></pre></div>
<p><img src="Class_separation_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="the-function-means">The function <code>means()</code><a class="anchor" aria-label="anchor" href="#the-function-means"></a>
</h2>
<p>This function controls the aesthetics of the class means in the
biplot. The function accepts as first argument an object of class
<code>biplot</code> where the aesthetics should be applied. Let us first
construct a CVA biplot of the <code>state.x77</code> data with samples
optimally separated according to <code>state.division</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/CVA.html">CVA</a></span><span class="op">(</span>classes <span class="op">=</span> <span class="va">state.division</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>means <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Class_separation_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>Instead of adding a legend, we can choose to label the class means.
Furthermore, the colour of each class mean defaults to the colour of the
samples. We wish to select a different colour and plotting character for
the class means.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/CVA.html">CVA</a></span><span class="op">(</span>classes <span class="op">=</span> <span class="va">state.division</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/means.html">means</a></span><span class="op">(</span>label <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"olivedrab"</span>, pch <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Class_separation_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>If we choose to only show the class means for the central states, the
argument <code>which</code> is used either indicating the number(s) in
the sequence of levels (<code>which = 4:7</code>), or as shown below,
the levels themselves:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/CVA.html">CVA</a></span><span class="op">(</span>classes <span class="op">=</span> <span class="va">state.division</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/means.html">means</a></span> <span class="op">(</span>which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"West North Central"</span>, <span class="st">"West South Central"</span>, <span class="st">"East South Central"</span>, </span>
<span>                     <span class="st">"East North Central"</span><span class="op">)</span>, label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Class_separation_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>The size of the labels is controlled with <code>label.cex</code>
which can be specified either as a single value (for all class means) or
a vector indicating size values for each individual sample. The colour
of the labels defaults to the colour(s) of the class means. However,
individual label colours can be spesified with <code>label.col</code>,
similar to <code>label.cex</code> as either a single value of a vector
of length equal to the number of classes.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/CVA.html">CVA</a></span><span class="op">(</span>classes <span class="op">=</span> <span class="va">state.division</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/means.html">means</a></span> <span class="op">(</span>col <span class="op">=</span> <span class="st">"olivedrab"</span>, pch <span class="op">=</span> <span class="fl">15</span>, cex <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>         label <span class="op">=</span> <span class="cn">TRUE</span>, label.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"green"</span>,<span class="st">"gold"</span>,<span class="st">"cyan"</span>,<span class="st">"magenta"</span>,</span>
<span>                                     <span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"grey"</span>,<span class="st">"purple"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Class_separation_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>We can also make use of the functionality of the <code>ggrepel</code>
package to place the labels.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/CVA.html">CVA</a></span><span class="op">(</span>classes <span class="op">=</span> <span class="va">state.division</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>label <span class="op">=</span> <span class="st">"ggrepel"</span>, label.cex<span class="op">=</span><span class="fl">0.65</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/means.html">means</a></span> <span class="op">(</span>label <span class="op">=</span> <span class="st">"ggrepel"</span>, label.cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Class_separation_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="the-functions-fit-measures-and-summary">The functions <code>fit.measures()</code> and
<code>summary()</code><a class="anchor" aria-label="anchor" href="#the-functions-fit-measures-and-summary"></a>
</h2>
<p>There is a number of fit measures that are specific to CVA biplots.
The measures are computed with the function <code><a href="../reference/fit.measures.html">fit.measures()</a></code>
and the results are displayed by the function
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>.</p>
<p>Canonical variate analysis can be considered as a transformation of
the original variables to the canonical space followed by constructing a
PCA biplot of canonical variables. The matrix of class means <span class="math inline">\(\bar{\mathbf{X}} = (\mathbf{G'G})^{-1}
\mathbf{G'X}\)</span> is transformed to <span class="math inline">\(\mathbf{\bar{X}L}\)</span> where <span class="math inline">\(\mathbf{L}\)</span> is a non-singular matrix such
that <span class="math inline">\(\mathbf{LL'=W}^{-1}\)</span>.
Pricipal component analysis finds the orthogonal matrix <span class="math inline">\(\mathbf{V}\)</span> such that</p>
<p><span class="math display">\[
\mathbf{(L'\bar{X}'C\bar{X}L)V=V \Lambda}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{M = LV}\)</span> as defined
in section 1. The predicted values for the class means is given by</p>
<p><span class="math display">\[
\mathbf{\hat{\bar{X}}} = \mathbf{\bar{X}MJ}\mathbf{M}^{-1}.
\]</span></p>
<div class="section level3">
<h3 id="overall-quality-of-fit">Overall quality of fit<a class="anchor" aria-label="anchor" href="#overall-quality-of-fit"></a>
</h3>
<p>Based on the two-step process described above, there are two measures
of quality of fit. The quality of the approximation of the canonical
variables <span class="math inline">\(\mathbf{\bar{X}L}\)</span> in the
<span class="math inline">\(2\)</span>-dimensional display is given
by</p>
<p><span class="math display">\[
Quality (canonical \: variables) = \frac{tr(\mathbf{\Lambda
J})}{tr(\mathbf{\Lambda)}}
\]</span> and the quality of the approximation of the original variables
<span class="math inline">\(\mathbf{\bar{X}}\)</span> in the 2D CVA
biplot is given by</p>
<p><span class="math display">\[
Quality (original \: variables) = \frac{tr(\mathbf{\Lambda
J})}{tr(\mathbf{\Lambda)}}
\]</span></p>
</div>
<div class="section level3">
<h3 id="adequacy-of-representation-of-variables">Adequacy of representation of variables<a class="anchor" aria-label="anchor" href="#adequacy-of-representation-of-variables"></a>
</h3>
<p>The adequacy with which each of the variables is represented in the
biplot is given by the elementwise ratios</p>
<p><span class="math display">\[
Adequacy = \frac{diag(\mathbf{MJM'})}{diag(\mathbf{MM'})}.
\]</span></p>
</div>
<div class="section level3">
<h3 id="predictivity">Predictivity<a class="anchor" aria-label="anchor" href="#predictivity"></a>
</h3>
<div class="section level4">
<h4 id="between-class-predictivity">Between class predictivity<a class="anchor" aria-label="anchor" href="#between-class-predictivity"></a>
</h4>
<p>The axis and class mean predictivities are defined in terms of the
weighted class means.</p>
<div class="section level5">
<h5 id="axis-predictivity">Axis predictivity<a class="anchor" aria-label="anchor" href="#axis-predictivity"></a>
</h5>
<p>The elementwise ratios for the predictivity of each of the axes are
given by</p>
<p><span class="math display">\[
axis \: predictivity =
\frac{diag(\mathbf{\hat{\bar{X}}}'\mathbf{C\hat{\bar{X}}})}{diag(\mathbf{\bar{X}}'\mathbf{C\bar{X}})}.
\]</span></p>
</div>
<div class="section level5">
<h5 id="class-predictivity">Class predictivity<a class="anchor" aria-label="anchor" href="#class-predictivity"></a>
</h5>
<p>Similarly for each of the class means the elementwise ratio is
computed from</p>
<p><span class="math display">\[
class \: predictivity =
\frac{diag(\mathbf{C}^{\frac{1}{2}}\mathbf{\hat{\bar{X}}}'\mathbf{W^{-1}}\mathbf{\hat{\bar{X}}}\mathbf{C}^{\frac{1}{2}})}{diag(\mathbf{C}^{\frac{1}{2}}\mathbf{\bar{X}}'\mathbf{W^{-1}}\mathbf{\bar{X}}\mathbf{C}^{\frac{1}{2}})}.
\]</span></p>
</div>
</div>
<div class="section level4">
<h4 id="within-class-predictivity">Within class predictivity<a class="anchor" aria-label="anchor" href="#within-class-predictivity"></a>
</h4>
<p>We define the matrix of samples as deviations from their class means
as</p>
<p><span class="math display">\[
(\mathbf{I-H})\mathbf{X}=(\mathbf{I}_n-\mathbf{G}(\mathbf{G'G})^{-1}\mathbf{G}')\mathbf{X}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{H} =
\mathbf{G}(\mathbf{G'G})^{-1}\mathbf{G}'\)</span>.</p>
<div class="section level5">
<h5 id="within-class-axis-predictivity">Within class axis predictivity<a class="anchor" aria-label="anchor" href="#within-class-axis-predictivity"></a>
</h5>
<p>The within class axis predictivity is computed as the elementwise
ratios</p>
<p><span class="math display">\[
within \: class \: axis \: predictivity =
\frac{diag(\mathbf{\hat{X}}'(\mathbf{I-H)\hat{X}})}{diag(\mathbf{X}'(\mathbf{I-H)X})}.
\]</span></p>
</div>
<div class="section level5">
<h5 id="within-class-sample-predictivity">Within class sample predictivity<a class="anchor" aria-label="anchor" href="#within-class-sample-predictivity"></a>
</h5>
<p>Unlike PCA biplots, sample predictivity for CVA biplots are computed
for the observations expressed as deviations from their class means. The
elementwise ratios is obtained from</p>
<p><span class="math display">\[
within \: class \: axis \: predictivity =
\frac{diag(\mathbf{(I-H)\hat{X}}\mathbf{W}^{-1}\mathbf{\hat{X}'(I-H)})}{diag(\mathbf{(I-H)X}\mathbf{W}^{-1}\mathbf{X'(I-H)})}.
\]</span> To display the fit measures, we create a <code>biplot</code>
object with the measures added by the function
<code><a href="../reference/fit.measures.html">fit.measures()</a></code> and call <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>       <span class="fu"><a href="../reference/CVA.html">CVA</a></span><span class="op">(</span>classes <span class="op">=</span> <span class="va">state.division</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>       <span class="fu"><a href="../reference/fit.measures.html">fit.measures</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Class_separation_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span> <span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 50 samples and 8 variables.</span></span>
<span><span class="co">#&gt; 8 numeric variables.</span></span>
<span><span class="co">#&gt; 9 classes: New England Middle Atlantic South Atlantic East South Central West South Central East North Central West North Central Mountain Pacific </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Quality of fit of canonical variables = 70.7% </span></span>
<span><span class="co">#&gt; Quality of fit of original variables = 70.5% </span></span>
<span><span class="co">#&gt; Adequacy of variables:</span></span>
<span><span class="co">#&gt; Population     Income Illiteracy   Life Exp     Murder    HS Grad      Frost </span></span>
<span><span class="co">#&gt; 0.41716176 0.15621549 0.16136381 0.09759664 0.19426796 0.55332679 0.50497634 </span></span>
<span><span class="co">#&gt;       Area </span></span>
<span><span class="co">#&gt; 0.40661470 </span></span>
<span><span class="co">#&gt; Axis predictivity:</span></span>
<span><span class="co">#&gt; Population     Income Illiteracy   Life Exp     Murder    HS Grad      Frost </span></span>
<span><span class="co">#&gt;  0.1859124  0.4019427  0.8195756  0.6925389  0.7685373  0.9506355  0.7819324 </span></span>
<span><span class="co">#&gt;       Area </span></span>
<span><span class="co">#&gt;  0.8458143 </span></span>
<span><span class="co">#&gt; Class predictivity:</span></span>
<span><span class="co">#&gt;        New England    Middle Atlantic     South Atlantic East South Central </span></span>
<span><span class="co">#&gt;          0.7922047          0.6570417          0.8191791          0.8777759 </span></span>
<span><span class="co">#&gt; West South Central East North Central West North Central           Mountain </span></span>
<span><span class="co">#&gt;          0.7416085          0.6370315          0.3265978          0.6825966 </span></span>
<span><span class="co">#&gt;            Pacific </span></span>
<span><span class="co">#&gt;          0.6700194 </span></span>
<span><span class="co">#&gt; Within class axis predictivity:</span></span>
<span><span class="co">#&gt; Population     Income Illiteracy   Life Exp     Murder    HS Grad      Frost </span></span>
<span><span class="co">#&gt; 0.04212318 0.09357501 0.25675620 0.19900223 0.29474972 0.75215233 0.31027358 </span></span>
<span><span class="co">#&gt;       Area </span></span>
<span><span class="co">#&gt; 0.12741853 </span></span>
<span><span class="co">#&gt; Within class sample predictivity:</span></span>
<span><span class="co">#&gt;        Alabama         Alaska        Arizona       Arkansas     California </span></span>
<span><span class="co">#&gt;    0.722548912    0.163442379    0.333341120    0.268976273    0.229139828 </span></span>
<span><span class="co">#&gt;       Colorado    Connecticut       Delaware        Florida        Georgia </span></span>
<span><span class="co">#&gt;    0.264963758    0.082284385    0.593415987    0.461070888    0.636531435 </span></span>
<span><span class="co">#&gt;         Hawaii          Idaho       Illinois        Indiana           Iowa </span></span>
<span><span class="co">#&gt;    0.015640188    0.113711473    0.338612599    0.389208196    0.507060148 </span></span>
<span><span class="co">#&gt;         Kansas       Kentucky      Louisiana          Maine       Maryland </span></span>
<span><span class="co">#&gt;    0.784831952    0.314119027    0.078465054    0.008388471    0.306141816 </span></span>
<span><span class="co">#&gt;  Massachusetts       Michigan      Minnesota    Mississippi       Missouri </span></span>
<span><span class="co">#&gt;    0.076563044    0.218470793    0.645446212    0.046129058    0.710971640 </span></span>
<span><span class="co">#&gt;        Montana       Nebraska         Nevada  New Hampshire     New Jersey </span></span>
<span><span class="co">#&gt;    0.086279776    0.810374638    0.090490164    0.298187909    0.003496353 </span></span>
<span><span class="co">#&gt;     New Mexico       New York North Carolina   North Dakota           Ohio </span></span>
<span><span class="co">#&gt;    0.007134343    0.024268121    0.422776032    0.446240464    0.277262145 </span></span>
<span><span class="co">#&gt;       Oklahoma         Oregon   Pennsylvania   Rhode Island South Carolina </span></span>
<span><span class="co">#&gt;    0.450104680    0.108636860    0.033945796    0.415029328    0.261568299 </span></span>
<span><span class="co">#&gt;   South Dakota      Tennessee          Texas           Utah        Vermont </span></span>
<span><span class="co">#&gt;    0.134881180    0.247921823    0.110537439    0.500454605    0.159941068 </span></span>
<span><span class="co">#&gt;       Virginia     Washington  West Virginia      Wisconsin        Wyoming </span></span>
<span><span class="co">#&gt;    0.310439564    0.030877305    0.066303623    0.295499472    0.474458397</span></span></code></pre></div>
<p>The call to <code><a href="../reference/biplot.html">biplot()</a></code>, <code><a href="../reference/CVA.html">CVA()</a></code> and
<code><a href="../reference/fit.measures.html">fit.measures()</a></code> is required to (a) create an object of class
<code>biplot</code>, (b) extend the object to class <code>CVA</code> and
(c) compute the fit measures. The call to the function
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> is optional. It is further possible to select which
fit measures to display in the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function where all
measures default to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>       <span class="fu"><a href="../reference/CVA.html">CVA</a></span><span class="op">(</span>classes <span class="op">=</span> <span class="va">state.region</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>       <span class="fu"><a href="../reference/fit.measures.html">fit.measures</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span> <span class="op">(</span><span class="va">obj</span>, adequacy <span class="op">=</span> <span class="cn">FALSE</span>, within.class.axis.predictivity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>         within.class.sample.predictivity <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 50 samples and 8 variables.</span></span>
<span><span class="co">#&gt; 8 numeric variables.</span></span>
<span><span class="co">#&gt; 4 classes: Northeast South North Central West </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Quality of fit of canonical variables = 91.9% </span></span>
<span><span class="co">#&gt; Quality of fit of original variables = 95.3% </span></span>
<span><span class="co">#&gt; Axis predictivity:</span></span>
<span><span class="co">#&gt; Population     Income Illiteracy   Life Exp     Murder    HS Grad      Frost </span></span>
<span><span class="co">#&gt;  0.9873763  0.9848608  0.8757913  0.9050208  0.9955088  0.9970346  0.9558192 </span></span>
<span><span class="co">#&gt;       Area </span></span>
<span><span class="co">#&gt;  0.9344651 </span></span>
<span><span class="co">#&gt; Class predictivity:</span></span>
<span><span class="co">#&gt;     Northeast         South North Central          West </span></span>
<span><span class="co">#&gt;     0.8031465     0.9985089     0.6449906     0.9988469</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="additional-cva-dimensions">Additional CVA dimensions<a class="anchor" aria-label="anchor" href="#additional-cva-dimensions"></a>
</h2>
<p>It was mentioned that the eigen equation (1) has <span class="math inline">\(min(p, G-1)\)</span> non-zero eigenvalues. This
implies that the CVA biplot for <span class="math inline">\(G=2\)</span>
groups, reduces to a single dimension. If we write</p>
<p><span class="math display">\[
\mathbf{M} = \begin{bmatrix}
             \mathbf{m}_1 &amp; \mathbf{M}^*
             \end{bmatrix}
\]</span> the columns of <span class="math inline">\(\mathbf{M}^*\)</span> forms a basis for the
orthogonal complement of the canonical space defined by <span class="math inline">\(\mathbf{m}\)</span>_1. The argument
<code>low.dim</code> determines how to uniquely define the second and
third dimensions. By default <code>low.dim = "sample.opt"</code> which
selects the dimensions by minimising total squared reconstruction error
for samples.</p>
<p>The representation of the canonical variates <span class="math inline">\(\bar{\mathbf{Z}} =
\bar{\mathbf{X}}\mathbf{m}_1\)</span> are exact in the first dimension,
but not the representation of the individual samples <span class="math inline">\({\mathbf{Z}} = {\mathbf{X}}\mathbf{m}_1\)</span>.
If we define <span class="math inline">\(\mathbf{\hat{X}} =
\mathbf{XMJ}\mathbf{M}^{-1}\)</span> with <span class="math inline">\(\mathbf{J}\)</span> a square matrix of zeros
except for a <span class="math inline">\(1\)</span> in the first
diagonal position, then the total square reconstruction error for
samples is given by</p>
<p><span class="math display">\[
TSRES =
tr{(\mathbf{X}-\mathbf{\hat{X}})'(\mathbf{X}-\mathbf{\hat{X}})}.
\]</span> Define <span class="math display">\[
\mathbf{M}^{-1} = \begin{bmatrix}
\mathbf{M}^{(1)}:(G-1) \times p \\
\mathbf{M}^{(2)}: (p-G+1) \times p
\end{bmatrix}
\]</span></p>
<p>then <span class="math inline">\(TSRES\)</span> is minimised when</p>
<p><span class="math display">\[
  \mathbf{M}^{opt} = \begin{bmatrix}
  \mathbf{M}_1 &amp; \mathbf{M}^*\mathbf{V}
  \end{bmatrix}
\]</span></p>
<pre><code>where $\mathbf{V}$ is the matrix of right singular vectors of $\mathbf{M}^{(2)}\mathbf{M}^{(2)'}$. </code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">state.2group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">state.division</span> <span class="op">==</span> <span class="st">"New England"</span> <span class="op">|</span> </span>
<span>                       <span class="va">state.division</span> <span class="op">==</span> <span class="st">"Middle Atlantic"</span>  <span class="op">|</span></span>
<span>                       <span class="va">state.division</span> <span class="op">==</span> <span class="st">"South Atlantic"</span> <span class="op">|</span></span>
<span>                       <span class="va">state.division</span> <span class="op">==</span> <span class="st">"Pacific"</span>,</span>
<span>                       <span class="st">"Coastal"</span>, <span class="st">"Central"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/biplot.html">biplot</a></span> <span class="op">(</span><span class="va">state.x77</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/CVA.html">CVA</a></span> <span class="op">(</span><span class="va">state.2group</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>means<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in CVA.biplot(biplot(state.x77), state.2group): The dimension of the</span></span>
<span><span class="co">#&gt; canonical space &lt; dim.biplot sample.opt method used for additional</span></span>
<span><span class="co">#&gt; dimension(s).</span></span></code></pre></div>
<p><img src="Class_separation_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p><span class="citation">@leRouxLubbe2024</span> discuss an alternative
method for obtaining additional dimensions. When assuming underlying
normal distributions, the Bhattacharyya distance can be optimised. This
method is specific to the two class case and cannot be utilised to find
a third dimension in a 3D CVA biplot with three classes.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span> <span class="op">(</span><span class="va">state.x77</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/CVA.html">CVA</a></span> <span class="op">(</span><span class="va">state.2group</span>, low.dim<span class="op">=</span><span class="st">"Bha"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>means<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in CVA.biplot(biplot(state.x77), state.2group, low.dim = "Bha"): The</span></span>
<span><span class="co">#&gt; dimension of the canonical space &lt; dim.biplot Bhattacharyya.dist method used</span></span>
<span><span class="co">#&gt; for additional dimension(s).</span></span></code></pre></div>
<p><img src="Class_separation_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="analysis-of-distance-aod">Analysis of Distance (AoD)<a class="anchor" aria-label="anchor" href="#analysis-of-distance-aod"></a>
</h2>
<p>Similar to the variance decomposition in CVA, analysis of distance
decomposes the total sum of squared distances into a sum of squared
distances between class means component and a sum of squared distances
within classes component.</p>
<p>Consider any Euclidean embeddable distance metric <span class="math inline">\(\psi_{ij}=\psi(\mathbf{x}_i,\mathbf{x}_j)\)</span>.
For a Euclidean embeddable metric it is possible to find high
dimensional coordinates <span class="math inline">\(\mathbf{y}_i\)</span> and <span class="math inline">\(\mathbf{y}_j\)</span> such that the Euclidean
distance between <span class="math inline">\(\mathbf{y}_i\)</span> and
<span class="math inline">\(\mathbf{y}_j\)</span> is equal to <span class="math inline">\(\psi_{ij}\)</span>. Let the matrix <span class="math inline">\(\mathbf{\tilde\Psi}\)</span> contain the values
<span class="math inline">\(-\frac{1}2{}\psi_{ij}^2\)</span> and
similarly <span class="math inline">\(\mathbf{\tilde\Delta}\)</span> the
values <span class="math inline">\(-\frac{1}2{}\delta_{hk}^2\)</span>
where <span class="math inline">\(\delta_{hk}\)</span> represent the
distance between class means <span class="math inline">\(h\)</span> and
<span class="math inline">\(k\)</span>.</p>
<p><span class="math display">\[
\mathbf{T} = \mathbf{B} + \mathbf{W}
\]</span></p>
<p><span class="math display">\[
\mathbf{1'\tilde\Psi1} = \mathbf{n'\tilde\Delta n} +
\sum_{k=1}^{G} \frac{n}{n_k}
\mathbf{g}_k'\mathbf{\tilde\Psi}\mathbf{g}_k
\]</span> where <span class="math inline">\(\mathbf{n}=\mathbf{(G'G)1}\)</span>. Thus, AoD
differs from CVA in allowing any Euclidean embeddable measure of
inter-class distance. As with CVA, these distances may be represented in
maps with point representing the class means, supplemented by additional
points representing the within-group variation. Principal coordinate
analysis is performed, only on the <span class="math inline">\(G \times
G\)</span> matrix <span class="math inline">\(\mathbf{\tilde\Delta}\)</span>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/AoD.html">AoD</a></span><span class="op">(</span>classes <span class="op">=</span> <span class="va">state.region</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Class_separation_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>By default linear regression biplot axes are fitted to the plot.
Alternatively, spline axes can be constructed.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/AoD.html">AoD</a></span><span class="op">(</span>classes <span class="op">=</span> <span class="va">state.region</span>, axes <span class="op">=</span> <span class="st">"splines"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Class_separation_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<pre><code><span><span class="co">#&gt; Calculating spline axis for variable 1 </span></span>
<span><span class="co">#&gt; Calculating spline axis for variable 2 </span></span>
<span><span class="co">#&gt; Calculating spline axis for variable 3 </span></span>
<span><span class="co">#&gt; Calculating spline axis for variable 4 </span></span>
<span><span class="co">#&gt; Calculating spline axis for variable 5 </span></span>
<span><span class="co">#&gt; Calculating spline axis for variable 6 </span></span>
<span><span class="co">#&gt; Calculating spline axis for variable 7 </span></span>
<span><span class="co">#&gt; Calculating spline axis for variable 8</span></span></code></pre>
<p>As an illustration of a Euclidean embeddable distance metric, other
than Euclidean distance itself, we can construct an AoD biplot with the
square root of the Manhattan distance.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/AoD.html">AoD</a></span><span class="op">(</span>classes <span class="op">=</span> <span class="va">state.region</span>, axes <span class="op">=</span> <span class="st">"splines"</span>, dist.func<span class="op">=</span><span class="va">sqrtManhattan</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Class_separation_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<pre><code><span><span class="co">#&gt; Calculating spline axis for variable 1 </span></span>
<span><span class="co">#&gt; Calculating spline axis for variable 2 </span></span>
<span><span class="co">#&gt; Calculating spline axis for variable 3 </span></span>
<span><span class="co">#&gt; Calculating spline axis for variable 4 </span></span>
<span><span class="co">#&gt; Calculating spline axis for variable 5 </span></span>
<span><span class="co">#&gt; Calculating spline axis for variable 6 </span></span>
<span><span class="co">#&gt; Calculating spline axis for variable 7 </span></span>
<span><span class="co">#&gt; Calculating spline axis for variable 8</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sugnet Lubbe, Niël le Roux, Johané Nienkemper-Swanepoel, Raeesa Ganey, Ruan Buys, Zoë-Mae Adams, Peter Manefeldt.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
