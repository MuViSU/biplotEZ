<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CA in biplotEZ • biplotEZ</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="CA in biplotEZ">
<meta property="og:description" content="biplotEZ">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biplotEZ</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/biplotEZ.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/biplotEZ_enhancements.html">biplotEZ enhancements</a>
    </li>
    <li>
      <a href="../articles/Biplots_in_1D.html">Biplots in 1D</a>
    </li>
    <li>
      <a href="../articles/Biplots_in_3D.html">Biplots in 3D</a>
    </li>
    <li>
      <a href="../articles/CA_in_biplotEZ.html">CA in biplotEZ</a>
    </li>
    <li>
      <a href="../articles/Class_separation.html">Class separation</a>
    </li>
    <li>
      <a href="../articles/MDS.html">MDS</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>CA in biplotEZ</h1>
            
      
      
      <div class="hidden name"><code>CA_in_biplotEZ.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="what-is-a-correspondence-analysis">What is a Correspondence Analysis?<a class="anchor" aria-label="anchor" href="#what-is-a-correspondence-analysis"></a>
</h2>
<p>In its simplest form Correspondence Analysis (CA) aims to expose the
association between two categorical variables by utilising a two-way
frequency table. Numerous variants of CA are available for the
application to diverse problems, the interested reader is referred to:
<span class="citation">Gower, Lubbe, and Roux (2011)</span>, <span class="citation">Beh and Lombardo (2014)</span>.</p>
<p>In <code>biplotEZ</code> focus will be places on three
<em>EZ</em>-to-use versions based on the Pearson residuals (<span class="citation">Gower, Lubbe, and Roux (2011)</span>: Page 300).</p>
<p>Now, the two-way frequency table is also referred to as the data
matrix: <span class="math inline">\(\mathbf{X}:r\times c\)</span>. This
data matrix is different from the continuous case used for the
<code><a href="../reference/PCA.html">PCA()</a></code> and <code><a href="../reference/CVA.html">CVA()</a></code> examples, as it represents the
cross-tabulations of two categorical variables (i.e. factors), each with
a finite number of levels (i.e response values). The elements of the
data matrix represent the frequency of the co-occurrence of two
particular levels of the two variables. Consider the
<code>HairEyeColor</code> data set in <code>R</code>, which summarises
the hair and eye color of male and female statistics students. For the
purpose of this example only the male students will be considered:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">HairEyeColor</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">X</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair    Brown Blue Hazel Green</span></span>
<span><span class="co">#&gt;   Black    32   11    10     3</span></span>
<span><span class="co">#&gt;   Brown    53   50    25    15</span></span>
<span><span class="co">#&gt;   Red      10   10     7     7</span></span>
<span><span class="co">#&gt;   Blond     3   30     5     8</span></span></code></pre></div>
<p>The grand total of the table <span class="math inline">\(N\)</span>
is obtained from the total of all frequencies:</p>
<p><span class="math display">\[
\sum_{r=1}^{R}\sum_{c=1}^{C}x_{rc}=N
\]</span></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="va">N</span></span>
<span><span class="co">#&gt; [1] 279</span></span></code></pre></div>
<p>It is common to work with the proportions rather than the frequencies
in terms of the correspondence matrix, <span class="math inline">\(\mathbf{P}\)</span>:</p>
<p><span class="math display">\[
\mathbf{P}=\frac{\mathbf{X}}{N}
\]</span></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">/</span><span class="va">N</span></span>
<span><span class="va">P</span></span>
<span><span class="co">#&gt;        Eye</span></span>
<span><span class="co">#&gt; Hair         Brown       Blue      Hazel      Green</span></span>
<span><span class="co">#&gt;   Black 0.11469534 0.03942652 0.03584229 0.01075269</span></span>
<span><span class="co">#&gt;   Brown 0.18996416 0.17921147 0.08960573 0.05376344</span></span>
<span><span class="co">#&gt;   Red   0.03584229 0.03584229 0.02508961 0.02508961</span></span>
<span><span class="co">#&gt;   Blond 0.01075269 0.10752688 0.01792115 0.02867384</span></span></code></pre></div>
<p>Other useful summaries of <span class="math inline">\(\mathbf{P}\)</span> include the row and column
masses (for arbitrary row and column <span class="math inline">\(r\)</span> and <span class="math inline">\(c\)</span>, respectively), also expressed as
diagonal matrices:</p>
<p><span class="math display">\[
\mathbf{r}_r = \sum_{c=1}^{C}p_{rc}; \hspace{0.5 cm}
\mathbf{c}_c = \sum_{r=1}^{R}p_{rc}\\
\mathbf{r}=\mathbf{P1}; \hspace{0.5 cm}
\mathbf{c}=\mathbf{P}^\prime\mathbf{1}
\]</span></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rMass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span>
<span><span class="va">rMass</span></span>
<span><span class="co">#&gt;     Black     Brown       Red     Blond </span></span>
<span><span class="co">#&gt; 0.2007168 0.5125448 0.1218638 0.1648746</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cMass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span></span>
<span><span class="va">cMass</span></span>
<span><span class="co">#&gt;     Brown      Blue     Hazel     Green </span></span>
<span><span class="co">#&gt; 0.3512545 0.3620072 0.1684588 0.1182796</span></span></code></pre></div>
<p>Diagonal matrices:</p>
<p><span class="math display">\[
\mathbf{D_r}=\text{diag}(\mathbf{r}); \hspace{0.5 cm}
\mathbf{D_c}=\text{diag}(\mathbf{c})
\]</span></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">P</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Dr</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.2007168 0.0000000 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; [2,] 0.0000000 0.5125448 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; [3,] 0.0000000 0.0000000 0.1218638 0.0000000</span></span>
<span><span class="co">#&gt; [4,] 0.0000000 0.0000000 0.0000000 0.1648746</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">P</span>, <span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Dc</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.3512545 0.0000000 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; [2,] 0.0000000 0.3620072 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; [3,] 0.0000000 0.0000000 0.1684588 0.0000000</span></span>
<span><span class="co">#&gt; [4,] 0.0000000 0.0000000 0.0000000 0.1182796</span></span></code></pre></div>
<p>In order to obtain the first form of the row and column coordinates,
the singular value decomposition (SVD) of the matrix of standardised
Pearson residuals (<span class="math inline">\(\mathbf{S}\)</span>) is
computed:</p>
<p><span class="math display">\[
\begin{aligned}
\text{SVD}(\mathbf{S}) &amp;=
\text{SVD}\left(\mathbf{D_r^{-\frac{1}{2}}}(\mathbf{P}-\mathbf{rc^\prime})\mathbf{D_c^{-\frac{1}{2}}}\right)\\&amp;=
\mathbf{U\Lambda V^\prime}
\end{aligned}
\]</span> The return value for the Standardised pearson residuals is
<code>Smat</code> and the singular value decomposition,
<code>SVD</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Smat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">Dr</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="op">(</span><span class="va">P</span><span class="op">-</span><span class="op">(</span><span class="va">Dr</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span>  <span class="va">Dc</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">Dc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">svd.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">Smat</span><span class="op">)</span></span></code></pre></div>
<p>This is linked to the <span class="math inline">\(\chi^2\)</span>-statistic to determine whether the
two categorical variables (i.e. the rows and columns of the contingency
table) are independent. The expected frequencies represented by the
product of the row and column masses (<span class="math inline">\(\mathbf{rc^\prime}\)</span>).</p>
<p>Furthermore, since the weights of certain objects might be
substantially different from others which could result in a distorted
approximation in lower dimension, the <span class="math inline">\(\chi^2\)</span>-distance, also referred to as the
weighted Euclidean distance, is rather used to measure distances in CA.
This is an intuitive decision as it follows from the <span class="math inline">\(\chi^2\)</span>-statistic to test the independence
between two categorical variables, in this case the independence between
the rows and columns of the contingency table. (<span class="citation">Beh and Lombardo (2014)</span>, <span class="citation">Greenacre (2017)</span>).</p>
</div>
<div class="section level2">
<h2 id="ca-biplot">CA biplot<a class="anchor" aria-label="anchor" href="#ca-biplot"></a>
</h2>
<div class="section level3">
<h3 id="coordinates">Coordinates<a class="anchor" aria-label="anchor" href="#coordinates"></a>
</h3>
<p>In order to construct a biplot in which the distances between the row
and column coordinates are meaningful an asymmetric display should be
constructed. This means that the contribution of the singular values
should be different for the row and column coordinates. (<span class="citation">Gabriel (1971)</span>) The standard coordinates are
expressed by:</p>
<p><span class="math display">\[
\begin{aligned}
\text{Row standard coordinates:} \hspace{0.5 cm}&amp;\mathbf{U}\\
\text{Column standard coordinates:} \hspace{0.5 cm}&amp;\mathbf{V}
\end{aligned}
\]</span></p>
<p>The principal coordinates are expressed by:</p>
<p><span class="math display">\[
\begin{aligned}
\text{Row principal coordinates:} \hspace{0.5
cm}&amp;\mathbf{U\Lambda}\\
\text{Column principal coordinates:} \hspace{0.5
cm}&amp;\mathbf{V\Lambda}
\end{aligned}
\]</span></p>
<p>By including the singular values the magnitude of the association
between the variables are incorporated in the scaling of the
coordinates.</p>
<p>In the <code>ca()</code> function the argument <code>variant</code>
allows the user to choose between three types of CA biplots:
<code>Princ</code>, <code>Stand</code> and <code>Symmetric</code>.</p>
<p><span class="math display">\[
\begin{aligned}
\text{Row coordinates:} \hspace{0.5 cm}&amp;\mathbf{U\Lambda^\gamma}\\
\text{Column coordinates:} \hspace{0.5
cm}&amp;\mathbf{V\Lambda^{1-\gamma}}
\end{aligned}
\]</span> The row standard (i.e. column principal) coordinate biplot:
<code>Stand</code>, results from <span class="math inline">\(\gamma=0\)</span>.</p>
<p>The row principal (i.e. column standard) coordinate biplot:
<code>Princ</code>, results from <span class="math inline">\(\gamma=1\)</span>.</p>
<p>The symmetric plot in which row and column coordinates are scaled
equally: <code>Symmetric</code>, results from <span class="math inline">\(\gamma=0.5\)</span>.</p>
<p>The return value is <code>rowcoor</code> and <code>colcoor</code>,
respectively.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rowcoor</span> <span class="op">&lt;-</span> <span class="va">svd.out</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">svd.out</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="va">gamma</span><span class="op">)</span></span>
<span><span class="va">colcoor</span> <span class="op">&lt;-</span> <span class="va">svd.out</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">svd.out</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">gamma</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-quality-of-the-biplot-display">The quality of the biplot display<a class="anchor" aria-label="anchor" href="#the-quality-of-the-biplot-display"></a>
</h3>
<p>This is measured by the ratio of the variance explained (sum of the
squared singular values of the utilised (<span class="math inline">\(M\)</span>) components) and the total variance
(sum of all squared singular values (<span class="math inline">\(p\)</span>)).</p>
<p><span class="math display">\[
\frac{\sum_{m=1}^{M}\lambda_m^2}{\sum_{m=1}^{p}\lambda_m^2}
\]</span> The return value is <code>qual</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-function-ca">The function CA()<a class="anchor" aria-label="anchor" href="#the-function-ca"></a>
</h2>
<p>The function <code><a href="../reference/CA.html">CA()</a></code> requires a two-way contingency table
as input and will return an object of class <code>CA</code> and
<code>biplot</code>. As this is not a standard data matrix as for
<code>PCA</code> and <code>CVA</code>, scaling and centering is not
allowed on the two-way contingency table and a warning will be given if
either <code>scale</code> or <code>center</code> is specified as
<code>TRUE</code> in biplot()`.</p>
<div class="section level3">
<h3 id="variantprinc">
<code>Variant="Princ"</code><a class="anchor" aria-label="anchor" href="#variantprinc"></a>
</h3>
<p>The default CA biplot is a row principal coordinate biplot:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/CA.html">CA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="CA_in_biplotEZ_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="variantstand">
<code>Variant="Stand"</code><a class="anchor" aria-label="anchor" href="#variantstand"></a>
</h3>
<p>To construct the CA biplot for row standard coordinates:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ca.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/CA.html">CA</a></span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"Stand"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="CA_in_biplotEZ_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ca.out</span><span class="op">$</span><span class="va">qual</span></span>
<span><span class="co">#&gt; [1] 99.73298</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="variantsymmetric">
<code>Variant="Symmetric"</code><a class="anchor" aria-label="anchor" href="#variantsymmetric"></a>
</h3>
<p>To construct the symmetric CA map:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ca.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/CA.html">CA</a></span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"Symmetric"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="CA_in_biplotEZ_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ca.out</span><span class="op">$</span><span class="va">qual</span></span>
<span><span class="co">#&gt; [1] 99.73298</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="aesthetics-and-legend">Aesthetics and legend<a class="anchor" aria-label="anchor" href="#aesthetics-and-legend"></a>
</h3>
<p>The <code><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample()</a></code> function should be utilised to specify the
colours, plotting characters and expansion of the samples.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/CA.html">CA</a></span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"Princ"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/samples.html">samples</a></span><span class="op">(</span>col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cyan"</span>,<span class="st">"purple"</span><span class="op">)</span>, pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">17</span><span class="op">)</span>, label.side<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bottom"</span>,<span class="st">"top"</span><span class="op">)</span>, </span>
<span>          label.cex<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>samples <span class="op">=</span> <span class="cn">TRUE</span>, new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="CA_in_biplotEZ_files/figure-html/unnamed-chunk-12-1.png" width="672"><img src="CA_in_biplotEZ_files/figure-html/unnamed-chunk-12-2.png" width="672"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">HairEyeColor</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/CA.html">CA</a></span><span class="op">(</span>variant <span class="op">=</span> <span class="st">"Symmetric"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/samples.html">samples</a></span><span class="op">(</span>col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forestgreen"</span>,<span class="st">"magenta"</span><span class="op">)</span>, pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">17</span><span class="op">)</span>, label.side<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"top"</span>,<span class="st">"bottom"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>samples <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="CA_in_biplotEZ_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-BehLombardo2014" class="csl-entry">
Beh, E, and Rosaria Lombardo. 2014. <span>“Correspondence
Analysis.”</span> <em>Theory, Paractice and New Strategies</em>.
</div>
<div id="ref-Gabriel1971" class="csl-entry">
Gabriel, K. R. 1971. <span>“The Biplot Graphic Display of Matrices with
Application to Principal Component Analysis.”</span>
<em>Biometrika</em>, 453–67.
</div>
<div id="ref-UB2011" class="csl-entry">
Gower, J. C., S. Lubbe, and N. J. le Roux. 2011. <em>Understanding
Biplots.</em> Wiley.
</div>
<div id="ref-Greenacre2017" class="csl-entry">
Greenacre, M. J. 2017. <em>Correspondence Analysis in Practice.</em> CRC
press.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sugnet Lubbe, Niël le Roux, Johané Nienkemper-Swanepoel, Raeesa Ganey, Ruan Buys, Zoë-Mae Adams, Peter Manefeldt.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
