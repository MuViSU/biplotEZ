<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>biplotEZ • biplotEZ</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="biplotEZ">
<meta property="og:description" content="biplotEZ">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biplotEZ</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/biplotEZ.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/biplotEZ_enhancements.html">biplotEZ enhancements</a>
    </li>
    <li>
      <a href="../articles/Biplots_in_1D.html">Biplots in 1D</a>
    </li>
    <li>
      <a href="../articles/Biplots_in_3D.html">Biplots in 3D</a>
    </li>
    <li>
      <a href="../articles/CA_in_biplotEZ.html">CA in biplotEZ</a>
    </li>
    <li>
      <a href="../articles/Class_separation.html">Class separation</a>
    </li>
    <li>
      <a href="../articles/MDS.html">MDS</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>biplotEZ</h1>
            
      
      
      <div class="hidden name"><code>biplotEZ.Rmd</code></div>

    </div>

    
    
<p>The package provides users with an <em>EZ</em>-to-use way of
constructing multi-dimensional scatter plots of their data. The simplest
form of a biplot is the principal component analysis (PCA) biplot which
will be used for illustration in this vignette.</p>
<div class="section level2">
<h2 id="what-is-a-pca-biplot">What is a PCA biplot<a class="anchor" aria-label="anchor" href="#what-is-a-pca-biplot"></a>
</h2>
<p>Consider a data matrix <span class="math inline">\(\mathbf{X}^{*}:n
\times p\)</span> containing data on <span class="math inline">\(n\)</span> objects and <span class="math inline">\(p\)</span> variables. To produce a 2D biplot, we
need to optimally approximate <span class="math inline">\(\mathbf{X} =
(\mathbf{I}_n-\frac{1}{n}\mathbf{11}')\mathbf{X}^{*}\)</span>
(typically of rank <span class="math inline">\(p\)</span> with <span class="math inline">\(p&lt;n\)</span>) with a rank <span class="math inline">\(2\)</span> matrix. In terms of the least squares
error, we want to</p>
<p><span class="math display">\[
min \| \hat{\mathbf{X}}-\mathbf{X} \|^2
\]</span> where <span class="math inline">\(rank(\hat{\mathbf{X}})=2\)</span>. It was shown by
<span class="citation">Eckart and Young (1936)</span> that if the
singular value decomposition of <span class="math inline">\(\mathbf{X} =
\mathbf{UDV'}\)</span> then <span class="math display">\[
\hat{\mathbf{X}} = \mathbf{UJDJV'}
\]</span> with <span class="math display">\[
\mathbf{J} = \begin{bmatrix}
              \mathbf{I}_2 &amp; \mathbf{0}\\
              \mathbf{0} &amp; \mathbf{0}
             \end{bmatrix}
\]</span> essentially selecting only the first two columns of <span class="math inline">\(\mathbf{U}\)</span>, the diagonal matrix of the
first (largest) two singular values and the first two rows of <span class="math inline">\(\mathbf{V}'\)</span>. Define <span class="math display">\[
\mathbf{J}_2 = \begin{bmatrix}
                \mathbf{I}_2\\
                \mathbf{0}
               \end{bmatrix}
\]</span> then <span class="math inline">\(\mathbf{J}_2\mathbf{J}_2'
= \mathbf{J}\)</span> and we can write <span class="math inline">\(\hat{\mathbf{X}} =
(\mathbf{UDJ}_2)(\mathbf{VJ}_2)'\)</span>.</p>
<p><span class="citation">Gabriel (1971)</span> shows that any rank
<span class="math inline">\(2\)</span> matrix can be written as <span class="math display">\[\begin{equation}
  \hat{\mathbf{X}} = \mathbf{G} \mathbf{H}' \tag{1}
\end{equation}\]</span> where <span class="math inline">\(\mathbf{G}:n
\times 2\)</span> and <span class="math inline">\(\mathbf{H}:p \times
2\)</span>.The <span class="math inline">\(n\)</span> rows of <span class="math inline">\(\mathbf{G}\)</span> provide the <span class="math inline">\(n\)</span> pairs of 2D coordinates representing
the rows of <span class="math inline">\(\hat{\mathbf{X}}\)</span> and
the <span class="math inline">\(p\)</span> rows of <span class="math inline">\(\mathbf{H}\)</span> provide the <span class="math inline">\(p\)</span> pairs of 2D coordinates representing
the columns of <span class="math inline">\(\hat{\mathbf{X}}\)</span>.
Since <span class="math inline">\(\hat{\mathbf{X}} =
(\mathbf{UDJ}_2)(\mathbf{VJ}_2)'\)</span>, by setting <span class="math inline">\(\mathbf{G}=\mathbf{UDJ}_2\)</span> and <span class="math inline">\(\mathbf{H}=\mathbf{VJ}_2\)</span> we obtains the
best least squares approximation of <span class="math inline">\(\mathbf{X}\)</span>. <span class="citation">Gabriel (1971)</span> further shows that the
approximation of distances between the rows are optimal, while the
approximation of correlations by the cosines between the angles of the
rows of <span class="math inline">\(\mathbf{H}\)</span> is
sub-optimal.</p>
<p>The rows of <span class="math inline">\(\mathbf{G}\)</span> is
plotted as points, representing the samples. The rows of <span class="math inline">\(\mathbf{H}\)</span> provide the directions of the
axes for the variables. Since we have <span class="math display">\[
x^{*}_{ij}-\bar{x}_j = x_{ij} \approx \hat{x}_{ij} =
\mathbf{g}_{(i)}'\mathbf{h}_{(j)}
\]</span> all the values that will predict <span class="math inline">\(\mu\)</span> for variable <span class="math inline">\(j\)</span> is of the form <span class="math display">\[
\mu = \mathbf{g}'_{\mu}\mathbf{h}_{(j)}
\]</span> which defines a straight line orthogonal to <span class="math inline">\(\mathbf{h}_{(j)}\)</span> in the biplot space (see
the dotted red line in Figure 1(a)). To find the intersection of this
prediction line with <span class="math inline">\(\mathbf{h}_{(j)}\)</span> we note that <span class="math display">\[
\mathbf{g}'_{(i)}\mathbf{h}_{(j)} = \| \mathbf{g}_{(i)} \| \|
\mathbf{h}_{(j)} \| cos(\mathbf{g}_{(i)},\mathbf{h}_{(j)}) =
\| \mathbf{p} \| \| \mathbf{h}_{(j)} \|
\]</span> where <span class="math inline">\(\mathbf{p}\)</span> is the
length of the orthogonal projection of <span class="math inline">\(\mathbf{g}_{(i)}\)</span> on <span class="math inline">\(\mathbf{h}_{(j)}\)</span>. This is illustrated in
Figure 1(b) with triangle ABC: <span class="math inline">\(cos(\theta) =
\frac{AC}{AB}\)</span> or <span class="math inline">\(AC = AB
cos(\theta)\)</span> The length of <span class="math inline">\(AC\)</span>, written as <span class="math inline">\(\| \mathbf{p} \|\)</span> is equal to the cosine
times the length of <span class="math inline">\(AB\)</span>, i.e. <span class="math inline">\(cos(\mathbf{g}_{(i)},\mathbf{h}_{(j)}) \|
\mathbf{g}_{(i)} \|\)</span>.</p>
<div class="figure">
<img src="axis_calibration.png" alt="Figure 1: Calibration of biplot axes." width="100%"><p class="caption">
Figure 1: Calibration of biplot axes.
</p>
</div>
<p>Since <span class="math inline">\(\mathbf{p}\)</span> is along <span class="math inline">\(\mathbf{h}_{(j)}\)</span> we can write <span class="math inline">\(\mathbf{p} = c\mathbf{h}_{(j)}\)</span> and all
points on the prediction line <span class="math inline">\(\mu =
\mathbf{g}'_{\mu}\mathbf{h}_{(j)}\)</span> project on the same point
<span class="math inline">\(c_{\mu}\mathbf{h}_{(j)}\)</span>. We solve
for <span class="math inline">\(c_{\mu}\)</span> from <span class="math display">\[
\mu = \mathbf{g}'_{\mu}\mathbf{h}_{(j)}=\| \mathbf{p} \| \|
\mathbf{h}_{(j)} \| =
\| c_{\mu}\mathbf{h}_{(j)} \| \| \mathbf{h}_{(j)} \|
\]</span></p>
<p><span class="math display">\[
c_{\mu} = \frac{\mu}{\mathbf{h}_{(j)}'\mathbf{h}_{(j)}}.
\]</span> If we select ‘nice’ scale markers <span class="math inline">\(\tau_{1}, \tau_{2}, \cdots \tau_{k}\)</span> for
variable <span class="math inline">\(j\)</span>, then <span class="math inline">\(\tau_{h}-\bar{x}_j = \mu_{h}\)</span> and
positions of these scale markers on <span class="math inline">\(\mathbf{h}_{(j)}\)</span> are given by <span class="math inline">\(p_{\mu_{1}}, p_{\mu_{2}}, \cdots
p_{\mu_{k}}\)</span> with <span class="math display">\[
p_{\mu_h} = c_{\mu_h}\mathbf{h}_{(j)}
=  \frac{\mu_h}{\mathbf{h}_{(j)}'\mathbf{h}_{(j)}}\mathbf{h}_{(j)}
\tag{2}
\]</span> To obtain a PCA biplot of the <span class="math inline">\(48\times 4\)</span> rock data in <code>R</code> we
call</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">rock</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="the-function-biplot">The function <code>biplot()</code><a class="anchor" aria-label="anchor" href="#the-function-biplot"></a>
</h2>
<p>The function <code><a href="../reference/biplot.html">biplot()</a></code> takes a data set (usually) and
outputs an object of class <code>biplot</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">state.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span> <span class="op">(</span><span class="va">state.region</span>, <span class="va">state.x77</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 50 samples and 9 variables.</span></span>
<span><span class="co">#&gt; 8 numeric variables.</span></span>
<span><span class="co">#&gt; 1 categorical variable.</span></span></code></pre></div>
<p>Apart from specifying a data set, we can specify a single variable
for classification purposes.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, classes<span class="op">=</span><span class="va">state.region</span><span class="op">)</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 50 samples and 8 variables.</span></span>
<span><span class="co">#&gt; 8 numeric variables.</span></span>
<span><span class="co">#&gt; 4 classes: Northeast South North Central West</span></span></code></pre></div>
<p>If we want to use the variable <code>state.region</code> for
formatting, say colour coding the samples according to region, we
instead specify <code>grouping.aes</code> to indicate it pertains to the
aesthetics, rather than data structure. We can include or exclude the
aestethics variable from the data set.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, group.aes<span class="op">=</span><span class="va">state.region</span><span class="op">)</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 50 samples and 8 variables.</span></span>
<span><span class="co">#&gt; 8 numeric variables.</span></span></code></pre></div>
<p>Next, we look at centring and scaling of the numeric data matrix. As
we saw in section 1 above, PCA is computed from the centred data matrix.
For most methods, centring is either required or has no effect on the
methodology, therefore the default is <code>center = TRUE</code>. Since
centring is usually assumed, you will get a warning message, should you
explicitly choose to set <code>center = FALSE</code>. The default for
<code>scaled</code> is <code>FALSE</code>, but often when variables are
in different units of measurement, it is advisable to divide each
variable by its standard deviation which is accomplished by setting
`scale = TRUE’.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.data</span><span class="op">)</span>                 <span class="co"># centred, but no scaling</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 50 samples and 9 variables.</span></span>
<span><span class="co">#&gt; 8 numeric variables.</span></span>
<span><span class="co">#&gt; 1 categorical variable.</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.data</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>   <span class="co"># centered and scaled</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 50 samples and 9 variables.</span></span>
<span><span class="co">#&gt; 8 numeric variables.</span></span>
<span><span class="co">#&gt; 1 categorical variable.</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.data</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># no centring (usually not recommended) or scaling</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 50 samples and 9 variables.</span></span>
<span><span class="co">#&gt; 8 numeric variables.</span></span>
<span><span class="co">#&gt; 1 categorical variable.</span></span></code></pre></div>
<p>The final optional argument to the function is specifying a title for
your plot. We notice in the output above, that centring and / or scaling
has no effect on the <code>print method</code>. It does however have an
effect on the components of the object of class <code>biplot</code> in
the output.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.data</span><span class="op">)</span>                 <span class="co"># centred, but no scaling</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">center</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">scaled</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">means</span></span>
<span><span class="co">#&gt; Population     Income Illiteracy   Life.Exp     Murder    HS.Grad      Frost </span></span>
<span><span class="co">#&gt;  4246.4200  4435.8000     1.1700    70.8786     7.3780    53.1080   104.4600 </span></span>
<span><span class="co">#&gt;       Area </span></span>
<span><span class="co">#&gt; 70735.8800</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">sd</span></span>
<span><span class="co">#&gt; [1] 1 1 1 1 1 1 1 1</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.data</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>   <span class="co"># centered and scaled</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">center</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">scaled</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">means</span></span>
<span><span class="co">#&gt; Population     Income Illiteracy   Life.Exp     Murder    HS.Grad      Frost </span></span>
<span><span class="co">#&gt;  4246.4200  4435.8000     1.1700    70.8786     7.3780    53.1080   104.4600 </span></span>
<span><span class="co">#&gt;       Area </span></span>
<span><span class="co">#&gt; 70735.8800</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">sd</span></span>
<span><span class="co">#&gt;   Population       Income   Illiteracy     Life.Exp       Murder      HS.Grad </span></span>
<span><span class="co">#&gt; 4.464491e+03 6.144699e+02 6.095331e-01 1.342394e+00 3.691540e+00 8.076998e+00 </span></span>
<span><span class="co">#&gt;        Frost         Area </span></span>
<span><span class="co">#&gt; 5.198085e+01 8.532730e+04</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.data</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># no centring (usually not recommended) or scaling</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">center</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">scaled</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">means</span></span>
<span><span class="co">#&gt; [1] 0 0 0 0 0 0 0 0</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">sd</span></span>
<span><span class="co">#&gt; [1] 1 1 1 1 1 1 1 1</span></span></code></pre></div>
<p>Note that the components <code>means</code> and <code>sd</code> only
contain the sample means and sample sds when either/or
<code>center</code> and <code>scaled</code> is <code>TRUE</code>. For
values of <code>FALSE</code>, these components contain zeros for the
<code>means</code> and/or ones for the <code>sd</code> to ensure back
transformation will not have any affect.</p>
<div class="section level3">
<h3 id="using-biplot-with-princomp-or-prcomp">Using <code>biplot()</code> with <code>princomp()</code> or
<code>prcomp()</code><a class="anchor" aria-label="anchor" href="#using-biplot-with-princomp-or-prcomp"></a>
</h3>
<p>Should the user wish to construct a PCA biplot after performing
principal component analysis via the built in functions in the
<code>stats</code> package, the output from either of these functions
can be piped into the biplot function, where the piping implies that the
argument <code>data</code> now takes the value of an object of class
<code>prcomp</code> or <code>princomp</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/princomp.html" class="external-link">princomp</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 50 samples and 8 variables.</span></span>
<span><span class="co">#&gt; 8 numeric variables.</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">state.x77</span>, scale.<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">raw.X</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">raw.X</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;               Population Income Illiteracy Life Exp Murder HS Grad Frost   Area</span></span>
<span><span class="co">#&gt; Alabama             3615   3624        2.1    69.05   15.1    41.3    20  50708</span></span>
<span><span class="co">#&gt; Alaska               365   6315        1.5    69.31   11.3    66.7   152 566432</span></span>
<span><span class="co">#&gt; Arizona             2212   4530        1.8    70.55    7.8    58.1    15 113417</span></span>
<span><span class="co">#&gt; West Virginia       1799   3617        1.4    69.48    6.7    41.6   100  24070</span></span>
<span><span class="co">#&gt; Wisconsin           4589   4468        0.7    72.48    3.0    54.5   149  54464</span></span>
<span><span class="co">#&gt; Wyoming              376   4566        0.6    70.29    6.9    62.9   173  97203</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">X</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">X</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                Population      Income Illiteracy   Life Exp     Murder</span></span>
<span><span class="co">#&gt; Alabama       -0.14143156 -1.32113867   1.525758 -1.3621937  2.0918101</span></span>
<span><span class="co">#&gt; Alaska        -0.86939802  3.05824562   0.541398 -1.1685098  1.0624293</span></span>
<span><span class="co">#&gt; Arizona       -0.45568908  0.15330286   1.033578 -0.2447866  0.1143154</span></span>
<span><span class="co">#&gt; West Virginia -0.54819682 -1.33253061   0.377338 -1.0418703 -0.1836632</span></span>
<span><span class="co">#&gt; Wisconsin      0.07673438  0.05240289  -0.771082  1.1929438 -1.1859550</span></span>
<span><span class="co">#&gt; Wyoming       -0.86693413  0.21188994  -0.935142 -0.4384705 -0.1294853</span></span>
<span><span class="co">#&gt;                  HS Grad       Frost       Area</span></span>
<span><span class="co">#&gt; Alabama       -1.4619293 -1.62482920 -0.2347183</span></span>
<span><span class="co">#&gt; Alaska         1.6828035  0.91456761  5.8093497</span></span>
<span><span class="co">#&gt; Arizona        0.6180514 -1.72101848  0.5002047</span></span>
<span><span class="co">#&gt; West Virginia -1.4247868 -0.08580083 -0.5469045</span></span>
<span><span class="co">#&gt; Wisconsin      0.1723413  0.85685405 -0.1906996</span></span>
<span><span class="co">#&gt; Wyoming        1.2123316  1.31856256  0.3101835</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">center</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">scaled</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">means</span></span>
<span><span class="co">#&gt; Population     Income Illiteracy   Life Exp     Murder    HS Grad      Frost </span></span>
<span><span class="co">#&gt;  4246.4200  4435.8000     1.1700    70.8786     7.3780    53.1080   104.4600 </span></span>
<span><span class="co">#&gt;       Area </span></span>
<span><span class="co">#&gt; 70735.8800</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">sd</span></span>
<span><span class="co">#&gt;   Population       Income   Illiteracy     Life Exp       Murder      HS Grad </span></span>
<span><span class="co">#&gt; 4.464491e+03 6.144699e+02 6.095331e-01 1.342394e+00 3.691540e+00 8.076998e+00 </span></span>
<span><span class="co">#&gt;        Frost         Area </span></span>
<span><span class="co">#&gt; 5.198085e+01 8.532730e+04</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-functions-pca-plot-and-legend-type">The functions <code>PCA()</code>, <code>plot()</code> and
<code>legend.type()</code><a class="anchor" aria-label="anchor" href="#the-functions-pca-plot-and-legend-type"></a>
</h2>
<p>The first argument to the function <code><a href="../reference/PCA.html">PCA()</a></code> is an object of
class <code>biplot</code>, i.e. the output of the <code><a href="../reference/biplot.html">biplot()</a></code>
function. By default we c onstruct a 2D biplot (argument
<code>dim.biplot = 2</code>) of the first two principal components
(argument <code>e.vects = 1:2</code>). The <code>group.aes</code>
argument, if not specified in the function <code><a href="../reference/biplot.html">biplot()</a></code>, allows
a grouping argument for the sample aesthetics. A PCA biplot of the
<code>state.x77</code> data with colouring according to
<code>state.region</code> is obtained as follows:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span>group.aes <span class="op">=</span> <span class="va">state.region</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>The output of <code><a href="../reference/PCA.html">PCA()</a></code> is an object of class
<code>PCA</code> which inherits from the class <code>biplot</code>. Four
additional components are present in the <code>PCA</code> object. The
matrix <code>Z</code> contains the coordinates of the sample points,
while the matrix <code>Vr</code> contains the “coordinates” for the
variables. In the notation of equation (1), Z=<span class="math inline">\(\mathbf{G}:n \times 2\)</span> and Vr=<span class="math inline">\(\mathbf{H}:p \times 2\)</span>. The component
<code>Xhat</code> is the matrix <span class="math inline">\(\hat{\mathbf{X}}\)</span> on the left hand side of
equation (1). The final component <code>ax.one.unit</code> contains as
rows the expression in equation (2) with <span class="math inline">\(\mu_h=1\)</span>, in other words, one unit in the
positive direction of the biplot axis.</p>
<p>By piping the <code>PCA</code> class object (inheriting from class
<code>biplot</code>) to the generic <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function, the
<code><a href="../reference/plot.biplot.html">plot.biplot()</a></code> function constructs the biplot on the
graphical device. To add a legend to the biplot, we call</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span>group.aes <span class="op">=</span> <span class="va">state.region</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>samples <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>It was mentioned in section 1 that the default choice <span class="math inline">\(\mathbf{G}=\mathbf{UDJ}_2\)</span> and <span class="math inline">\(\mathbf{H}=\mathbf{VJ}_2\)</span> provides an
exact representation of the distances between the rows of <span class="math inline">\(\mathbf{\hat{X}}\)</span> which is an optimal
approximation in the least squares sense of the distances between the
rows of <span class="math inline">\(\mathbf{X}\)</span> (samples).
Alternatively, the correlations between the variables (columns of <span class="math inline">\(\mathbf{X}\)</span>) can be optimally approximated
by the cosines of the angles between the axes, leaving the approximation
of the distances between the samples to be suboptimal. In this case
<span class="math inline">\(\mathbf{G}=\mathbf{UJ}_2\)</span> and <span class="math inline">\(\mathbf{H}=\mathbf{VDJ}_2\)</span> and this biplot
is obtained by setting the argument
<code>correlation.biplot = TRUE</code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span>group.aes <span class="op">=</span> <span class="va">state.region</span>, correlation.biplot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>samples <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="the-function-samples">The function <code>samples()</code><a class="anchor" aria-label="anchor" href="#the-function-samples"></a>
</h2>
<p>This function controls the aesthetics of the sample points in the
biplot. The function accepts as first argument an object of class
<code>biplot</code> where the aesthetics should be applied. Let us first
construct a PCA biplot of the <code>state.x77</code> data with samples
coloured according to <code>state.division</code>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span>group.aes <span class="op">=</span> <span class="va">state.division</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>samples <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>Since the legend interferes with the sample points, we choose to
place the legend on a new page, by setting <code>new = TRUE</code> in
the <code>legend.type</code> function. Furthermore, we wish to select
colours, other than the defaults, for the divisions. We can also change
the opacity of the sample colours with the argument <code>opacity</code>
that has default 1.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span>group.aes <span class="op">=</span> <span class="va">state.division</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkorange"</span>, <span class="st">"gold"</span>, <span class="st">"chartreuse4"</span>, </span>
<span>                   <span class="st">"green"</span>, <span class="st">"salmon"</span>, <span class="st">"magenta"</span>, <span class="st">"#000000"</span>, <span class="st">"blue"</span><span class="op">)</span>,opacity <span class="op">=</span> <span class="fl">0.65</span>,pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>samples <span class="op">=</span> <span class="cn">TRUE</span>, new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-14-1.png" width="672"><img src="biplotEZ_files/figure-html/unnamed-chunk-14-2.png" width="672"></p>
<p>Furthermore we want to use a different plotting character for the
central regions.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span> <span class="op">(</span><span class="va">state.division</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "New England"        "Middle Atlantic"    "South Atlantic"    </span></span>
<span><span class="co">#&gt; [4] "East South Central" "West South Central" "East North Central"</span></span>
<span><span class="co">#&gt; [7] "West North Central" "Mountain"           "Pacific"</span></span></code></pre></div>
<p>We want to use <code>pch = 15</code> for the first three and final
two divisions and <code>pch = 1</code> for the remaining four
divisions.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span>group.aes <span class="op">=</span> <span class="va">state.division</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkorange"</span>, <span class="st">"gold"</span>, <span class="st">"chartreuse4"</span>, </span>
<span>                   <span class="st">"green"</span>, <span class="st">"salmon"</span>, <span class="st">"magenta"</span>, <span class="st">"black"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>           pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">15</span>, <span class="fl">15</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">15</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>samples <span class="op">=</span> <span class="cn">TRUE</span>, new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-16-1.png" width="672"><img src="biplotEZ_files/figure-html/unnamed-chunk-16-2.png" width="672"></p>
<p>To increase the size of the plotting characters of the eastern
states, we add the following:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span>group.aes <span class="op">=</span> <span class="va">state.division</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkorange"</span>, <span class="st">"gold"</span>, <span class="st">"chartreuse4"</span>, </span>
<span>                   <span class="st">"green"</span>, <span class="st">"salmon"</span>, <span class="st">"magenta"</span>, <span class="st">"black"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>           pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">15</span>, <span class="fl">15</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">15</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>           cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1.5</span>,<span class="fl">1</span>,<span class="fl">1.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>samples <span class="op">=</span> <span class="cn">TRUE</span>, new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-17-1.png" width="672"><img src="biplotEZ_files/figure-html/unnamed-chunk-17-2.png" width="672"></p>
<p>If we choose to only show the samples for the central states, the
argument <code>which</code> is used either indicating the number(s) in
the sequence of levels (<code>which = 4:7</code>), or as shown below,
the levels themselves:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span>group.aes <span class="op">=</span> <span class="va">state.division</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkorange"</span>, <span class="st">"gold"</span>, <span class="st">"chartreuse4"</span>, </span>
<span>                   <span class="st">"green"</span>, <span class="st">"salmon"</span>, <span class="st">"magenta"</span>, <span class="st">"black"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>           which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"West North Central"</span>, <span class="st">"West South Central"</span>, <span class="st">"East South Central"</span>, </span>
<span>                     <span class="st">"East North Central"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/legend.type.html">legend.type</a></span><span class="op">(</span>samples <span class="op">=</span> <span class="cn">TRUE</span>, new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-18-1.png" width="672"><img src="biplotEZ_files/figure-html/unnamed-chunk-18-2.png" width="672"></p>
<p>Note that since four regions are selected, the colour (and other
aesthetics) is applied to these regions in the order they are specified
in <code>which</code>. To add the sample names, the <code>label</code>
argument is set to <code>TRUE</code>. For large sample sizes, this is
not recommended, as overplotting will render the plot unusable. The size
of the labels is controlled with <code>label.cex</code> which can be
specified either as a single value (for all samples) or a vector
indicating size values for each individual sample. The colour of the
labels defaults to the colour(s) of the samples. However, individual
label colours can be spesified with <code>label.col</code>, similar to
<code>label.cex</code> as either a single value of a vector of length
equal to the number of samples.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
<p>We can use the arguments <code>label.cex</code>,
<code>label.side</code> and <code>label.offset</code> to make the plot
more legible with a little effort.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pennsylvania"</span>, <span class="st">"New Jersey"</span>, <span class="st">"Massachusetts"</span>,</span>
<span>                            <span class="st">"Minnesota"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PA"</span>, <span class="st">"NJ"</span>, <span class="st">"MA"</span>, <span class="st">"MN"</span><span class="op">)</span></span>
<span><span class="va">above</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Alaska"</span>, <span class="st">"California"</span>, <span class="st">"Texas"</span>, <span class="st">"New York"</span>, <span class="st">"Nevada"</span>, <span class="st">"Georgia"</span>, <span class="st">"Alabama"</span>,</span>
<span>                 <span class="st">"North Carolina"</span>, <span class="st">"Colorado"</span>, <span class="st">"Washington"</span>, <span class="st">"Illinois"</span>, <span class="st">"Michigan"</span>, <span class="st">"Arizon"</span>,</span>
<span>                 <span class="st">"Florida"</span>, <span class="st">"Ohio"</span>, <span class="st">"NJ"</span>, <span class="st">"Kansas"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">right.side</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"South Carolina"</span>, <span class="st">"Kentucky"</span>, <span class="st">"Rhode Island"</span>, <span class="st">"New Hampshire"</span>, <span class="st">"Virginia"</span>,</span>
<span>                      <span class="st">"Missouri"</span>, <span class="st">"Delaware"</span>, <span class="st">"Hawaii"</span>, <span class="st">"Oregon"</span>, <span class="st">"PA"</span>, <span class="st">"Nebraska"</span>, <span class="st">"Montana"</span>,</span>
<span>                      <span class="st">"Maryland"</span>, <span class="st">"Indiana"</span>, <span class="st">"Idaho"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">left.side</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wyoming"</span>, <span class="st">"Iowa"</span>, <span class="st">"MN"</span>, <span class="st">"Connecticut"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">label.offset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">label.offset</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Colorado"</span>, <span class="st">"Kansas"</span>, <span class="st">"Idaho"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">label.side</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"bottom"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">label.side</span><span class="op">[</span><span class="va">above</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"top"</span></span>
<span><span class="va">label.side</span><span class="op">[</span><span class="va">right.side</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"right"</span></span>
<span><span class="va">label.side</span><span class="op">[</span><span class="va">left.side</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"left"</span></span>
<span><span class="fu"><a href="../reference/biplot.html">biplot</a></span> <span class="op">(</span><span class="va">state.x77</span>, scaled<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>label<span class="op">=</span><span class="cn">TRUE</span>, label.cex<span class="op">=</span><span class="fl">0.6</span>, label.side<span class="op">=</span><span class="va">label.side</span>, label.offset<span class="op">=</span><span class="va">label.offset</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
<p>We can also make use of the functionality of the <code>ggrepel</code>
package to place the labels.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>label <span class="op">=</span> <span class="st">"ggrepel"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Use of `df$x` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `x` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$y` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `y` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$z` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `z` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$x` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `x` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$y` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `y` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$z` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `z` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$x` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `x` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$y` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `y` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$z` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `z` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$x` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `x` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$y` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `y` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$z` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `z` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$x` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `x` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$y` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `y` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$z` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `z` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$x` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `x` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$y` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `y` instead.</span></span>
<span><span class="co">#&gt; Warning: Use of `df$z` is discouraged.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `z` instead.</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-21-1.png" width="672"><img src="biplotEZ_files/figure-html/unnamed-chunk-21-2.png" width="672"></p>
<p>Additionally, the user can add customised label names to the samples
in the biplot. To do this, <code>label</code> must be set to
<code>TRUE</code> (or <code>"ggrepel"</code>) and
<code>label.name</code> is set to be a vector of size <code>n</code>
specifying the label names of the samples. In this case, the label name
is set to the first three characters of the state name (row names of the
data).</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>label <span class="op">=</span> <span class="st">"TRUE"</span>,label.name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/strtrim.html" class="external-link">strtrim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-22-1.png" width="672"></p>
<p>If the data plotted in the biplot is a multivariate time series, it
can make sense to connect the data points in order. Let us consider the
four quarters of the <code>UKgas</code> data set as four variables and
we represent the years as sample points in a PCA biplot.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gas.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span> <span class="op">(</span><span class="va">UKgas</span>, ncol<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gas.data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Q"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">gas.data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">60</span><span class="op">:</span><span class="fl">86</span></span>
<span><span class="va">even.labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="fl">14</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">gas.data</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>connected <span class="op">=</span> <span class="cn">TRUE</span>, connect.col<span class="op">=</span><span class="st">"red"</span>, label <span class="op">=</span> <span class="va">even.labels</span>, label.cex<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-23-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="the-function-means">The function <code>means()</code><a class="anchor" aria-label="anchor" href="#the-function-means"></a>
</h2>
<p>The function <code><a href="../reference/means.html">means()</a></code> allow changing the aesthetics for
group means specified by group.aes, when the argument
<code>show.group.means = TRUE</code> in the call to the function
<code><a href="../reference/PCA.html">PCA()</a></code>. The functionality of <code><a href="../reference/means.html">means()</a></code> mirrors
that of <code><a href="../reference/samples.html">samples()</a></code> and is discussed in detail in the
vignette <em>Class separation</em> where class means are more prominent
than in PCA biplots.</p>
</div>
<div class="section level2">
<h2 id="the-function-axes">The function <code>axes()</code><a class="anchor" aria-label="anchor" href="#the-function-axes"></a>
</h2>
<p>Similar to the <code><a href="../reference/samples.html">samples()</a></code> function, this function allows
for changing the aestethics of the biplot axes. The first argument to
<code><a href="../reference/axes.html">axes()</a></code> is an object of class <code>biplot</code>. The
<code>X.names</code> argument is typically not specified by the user,
but is required for the function to allow specifying which axes to
display in the <code>which</code> argument, by either speficying the
column numbers<br>
or the column names. The arguments <code>col</code>, <code>lwd</code>
and <code>lty</code> pertains to the axes themselves and can be
specified either as a scaler value (to be recycled) or a vector with
length equal to that of <code>which</code>.</p>
<p>To construct a PCA biplot of the rock data, displaying only the axes
for peri and shape with different colours for the two axes, different
line widths and line type 2, we need to following code:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">rock</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                               <span class="fu"><a href="../reference/axes.html">axes</a></span><span class="op">(</span>which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shape"</span>,<span class="st">"peri"</span><span class="op">)</span>, </span>
<span>                                    col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lightskyblue"</span>,<span class="st">"slategrey"</span><span class="op">)</span>,</span>
<span>                                    lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
<p>The following four arguments deal with the axis labels. The argument
<code>label.dir</code> is based on the graphics parameter
<code>las</code> and allows for labels to be either orthogonal to the
axis direction (<code>Orthog</code>), horisontal (<code>Hor</code>) or
parallel to the plot <code>Paral</code>. The argument
<code>label.line</code> fulfills the role of the <code>line</code>
argument in <code><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext()</a></code> to determine on which margin line (how
far from the plot) the label is placed while <code>label.col</code> and
<code>label.cex</code> is self-explanatory and defaults to the axis
colour and size 0.75. Note in for the illustration the in the code below
the colour vector has only three components, so that recycling is
applied.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">rock</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                               <span class="fu"><a href="../reference/axes.html">axes</a></span><span class="op">(</span>col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lightskyblue"</span>,<span class="st">"slategrey"</span>,<span class="st">"blue"</span><span class="op">)</span>,</span>
<span>                                    label.dir<span class="op">=</span><span class="st">"Hor"</span>, label.line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-25-1.png" width="672"></p>
<p>The function <code><a href="https://rdrr.io/r/base/pretty.html" class="external-link">pretty()</a></code> finds ‘nice’ tick marks where the
value specified in the argument <code>ticks</code> determine the
<em>desired</em> number of tick marks, although the observed number
could be different. The other <code>tick.*</code> arguments are similar
to their naming counterparts in <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par()</a></code> or
<code><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text()</a></code>. Since the tick labels are important to follow the
direction of increasing values of the axes, setting
<code>tick.label = FALSE</code> does not remove the tick marks
completely, but limits the labels to the smallest and largest value
visible in the plot. If the user would like to specify alternative names
for the axes, this can be done in the argument
<code>ax.names</code>.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">rock</span>, scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                               <span class="fu"><a href="../reference/axes.html">axes</a></span><span class="op">(</span>label.dir<span class="op">=</span><span class="st">"Paral"</span>,</span>
<span>                                    ticks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, tick.label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">F</span>, <span class="cn">F</span>, <span class="cn">T</span>, <span class="cn">T</span><span class="op">)</span>,</span>
<span>                                    ax.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"area"</span>, <span class="st">"perimeter"</span>, <span class="st">"shape"</span>, </span>
<span>                                                 <span class="st">"permeability in milli-Darcies"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-26-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="the-functions-fit-measures-and-summary">The functions <code>fit.measures()</code> and
<code>summary()</code><a class="anchor" aria-label="anchor" href="#the-functions-fit-measures-and-summary"></a>
</h2>
<p>The <code>print</code> method provides a short summary of the biplot
object.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in biplot(airquality): 42 rows deleted due to missing values</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">obj</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 111 samples and 6 variables.</span></span>
<span><span class="co">#&gt; 6 numeric variables.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following 42 sample-rows where removed due to missing values</span></span>
<span><span class="co">#&gt;  5 6 10 11 25 26 27 32 33 34 35 36 37 39 42 43 45 46 52 53 54 55 56 57 58 59 60 61 65 72 75 83 84 96 97 98 102 103 107 115 119 150</span></span></code></pre></div>
<p>The output from <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> will be very similar.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 111 samples and 6 variables.</span></span>
<span><span class="co">#&gt; 6 numeric variables.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following 42 sample-rows were removed due to missing values</span></span>
<span><span class="co">#&gt;  5 6 10 11 25 26 27 32 33 34 35 36 37 39 42 43 45 46 52 53 54 55 56 57 58 59 60 61 65 72 75 83 84 96 97 98 102 103 107 115 119 150</span></span></code></pre></div>
<p>Additional information about the biplot object is added by the
<code><a href="../reference/fit.measures.html">fit.measures()</a></code> function.</p>
<div class="section level3">
<h3 id="quality-of-approximation">Quality of approximation<a class="anchor" aria-label="anchor" href="#quality-of-approximation"></a>
</h3>
<p>We start with the identity</p>
<p><span class="math display">\[
\mathbf{X} = \mathbf{\hat{X}} + \mathbf{X-\hat{X}}
\]</span> which decomposes <span class="math inline">\(\mathbf{X}\)</span> into a fitted part</p>
<p><span class="math display">\[
\mathbf{\hat{X}} = \mathbf{UJDJV'} =
\mathbf{UDJ}_2(\mathbf{VJ}_2)' =
\mathbf{UDV'VJ}_2(\mathbf{VJ}_2)' = \mathbf{XVJV'}
\]</span></p>
<p>and the residual part <span class="math inline">\(\mathbf{X-\hat{X}}\)</span>. The lack of fit is
quantified by the quantity we are minimising</p>
<p><span class="math display">\[
\| \hat{\mathbf{X}}-\mathbf{X} \|^2
\]</span> where we have the orthogonal decomposition</p>
<p><span class="math display">\[
\|\mathbf{X}\|^2 = \|\hat{\mathbf{X}}\|^2 +
\|\hat{\mathbf{X}}-\mathbf{X} \|^2.
\]</span> The overall quality of fit is therefore defined as</p>
<p><span class="math display">\[
quality = \frac{\|\hat{\mathbf{X}}\|^2}{\|\mathbf{X}\|^2} =
\frac{tr(\mathbf{XX}')}{tr(\mathbf{\hat{X}\hat{X}'})} =
\frac{tr(\mathbf{X'X})}{tr(\mathbf{\hat{X}'\hat{X}})} =
\frac{tr(\mathbf{VD}^2\mathbf{V'})}{tr(\mathbf{VD}^2\mathbf{JV'})}.
\]</span> In <em>biplotEZ</em> the overall quality is displayed as a
percentage:</p>
<p><span class="math display">\[
quality =\frac{d_1^2+d_2^2}{d_1^2+\dots+d_p^2}100\%.
\]</span></p>
</div>
<div class="section level3">
<h3 id="adequacy-of-representation-of-the-variables">Adequacy of representation of the variables<a class="anchor" aria-label="anchor" href="#adequacy-of-representation-of-the-variables"></a>
</h3>
<p>Researchers who construct the PCA biplot representing the columns
with arrows (vectors) often fit the biplot with a unit circle. The
rationale being that perfect representation of a variable will have unit
length and the length of each arrow vs the distance to the unit circle
represent the adequacy with which the variable is represented.</p>
<p>By fitting the biplot with calibrated axes, it is much easier to read
off values for the variables, but the adequacy values can still be
computed from</p>
<p><span class="math display">\[
\frac{diag(\mathbf{V}_r\mathbf{V}_r')}{diag(\mathbf{VV}')}=
diag(\mathbf{V}_r\mathbf{V}_r')
\]</span></p>
<p>due to the orthogonality of the matrix <span class="math inline">\(\mathbf{V}:p \times p\)</span>.</p>
</div>
<div class="section level3">
<h3 id="predictivities">Predictivities<a class="anchor" aria-label="anchor" href="#predictivities"></a>
</h3>
<p>The predictivity provides a measure of who well the original values
are recovered from the biplot. An element that is well represented will
have a predictivity close to one, indicating that the sample or variable
values from prediction is close to the observed values. If an element is
poorly represented, the predicted values will be very different from the
original values and the predictivity value will be close to zero.</p>
<div class="section level4">
<h4 id="axis-predictivity">Axis predictivity<a class="anchor" aria-label="anchor" href="#axis-predictivity"></a>
</h4>
<p>The predictivity for each of the <span class="math inline">\(p\)</span> variables is computed as the
elementwise ratios</p>
<p><span class="math display">\[
axis \: predictivity =
\frac{diag(\mathbf{\hat{X}'\hat{X}})}{diag(\mathbf{X'X})}
\]</span></p>
</div>
<div class="section level4">
<h4 id="sample-predictivity">Sample predictivity<a class="anchor" aria-label="anchor" href="#sample-predictivity"></a>
</h4>
<p>The predictivity for each of the <span class="math inline">\(n\)</span> samples is computed as the elementwise
ratios</p>
<p><span class="math display">\[
sample \: predictivity =
\frac{diag(\mathbf{\hat{X}\hat{X}'})}{diag(\mathbf{XX'})}
\]</span> By calling the function <code><a href="../reference/fit.measures.html">fit.measures()</a></code> these
quantities are computed for the specific biplot object. The values are
displayed with the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fit.measures.html">fit.measures</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-29-1.png" width="672"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span> <span class="op">(</span><span class="va">obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 50 samples and 8 variables.</span></span>
<span><span class="co">#&gt; 8 numeric variables.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Quality of fit = 65.4% </span></span>
<span><span class="co">#&gt; Adequacy of variables:</span></span>
<span><span class="co">#&gt; Population     Income Illiteracy   Life Exp     Murder    HS Grad      Frost </span></span>
<span><span class="co">#&gt;  0.1848016  0.3586383  0.2215201  0.1760908  0.2915819  0.2696184  0.1513317 </span></span>
<span><span class="co">#&gt;       Area </span></span>
<span><span class="co">#&gt;  0.3464170 </span></span>
<span><span class="co">#&gt; Axis predictivity:</span></span>
<span><span class="co">#&gt; Population     Income Illiteracy   Life Exp     Murder    HS Grad      Frost </span></span>
<span><span class="co">#&gt;  0.3330216  0.7609185  0.7917091  0.6206172  0.8640485  0.7947530  0.4982299 </span></span>
<span><span class="co">#&gt;       Area </span></span>
<span><span class="co">#&gt;  0.5675169 </span></span>
<span><span class="co">#&gt; Sample predictivity:</span></span>
<span><span class="co">#&gt;        Alabama         Alaska        Arizona       Arkansas     California </span></span>
<span><span class="co">#&gt;     0.95126856     0.61373919     0.26327256     0.86308539     0.57062754 </span></span>
<span><span class="co">#&gt;       Colorado    Connecticut       Delaware        Florida        Georgia </span></span>
<span><span class="co">#&gt;     0.83358779     0.59003002     0.18284712     0.49725356     0.94461052 </span></span>
<span><span class="co">#&gt;         Hawaii          Idaho       Illinois        Indiana           Iowa </span></span>
<span><span class="co">#&gt;     0.01984127     0.70337480     0.33405270     0.30082350     0.96367113 </span></span>
<span><span class="co">#&gt;         Kansas       Kentucky      Louisiana          Maine       Maryland </span></span>
<span><span class="co">#&gt;     0.86554676     0.87758262     0.93717163     0.66553856     0.06362508 </span></span>
<span><span class="co">#&gt;             MA       Michigan             MN    Mississippi       Missouri </span></span>
<span><span class="co">#&gt;     0.47386267     0.26050188     0.89207404     0.93073099     0.11321791 </span></span>
<span><span class="co">#&gt;        Montana       Nebraska         Nevada  New Hampshire             NJ </span></span>
<span><span class="co">#&gt;     0.44603781     0.93570441     0.22393876     0.87499561     0.15979033 </span></span>
<span><span class="co">#&gt;     New Mexico       New York North Carolina   North Dakota           Ohio </span></span>
<span><span class="co">#&gt;     0.29304145     0.40609063     0.93004841     0.69011551     0.08810179 </span></span>
<span><span class="co">#&gt;       Oklahoma         Oregon             PA   Rhode Island South Carolina </span></span>
<span><span class="co">#&gt;     0.37520943     0.36273523     0.02176080     0.58625617     0.93187284 </span></span>
<span><span class="co">#&gt;   South Dakota      Tennessee          Texas           Utah        Vermont </span></span>
<span><span class="co">#&gt;     0.83804787     0.96006357     0.73748654     0.66209083     0.80365601 </span></span>
<span><span class="co">#&gt;       Virginia     Washington  West Virginia      Wisconsin        Wyoming </span></span>
<span><span class="co">#&gt;     0.58564755     0.33877314     0.85231725     0.82519206     0.42499724</span></span></code></pre></div>
<p>If is not necessary to call the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function to
obtain the fit measures, but one of the biplot methods, such as
<code><a href="../reference/PCA.html">PCA()</a></code> is required, since the measures differ depending on
which type of biplot is constructed. To suppress the output of some fit
measures, for instance if the interest is in the axis predictivity and
there are many samples which result in a very long output, these can be
set in the call to <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>. By default all measures are
set to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/fit.measures.html">fit.measures</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span> <span class="op">(</span><span class="va">obj</span>, adequacy <span class="op">=</span> <span class="cn">FALSE</span>, sample.predictivity <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Object of class biplot, based on 50 samples and 8 variables.</span></span>
<span><span class="co">#&gt; 8 numeric variables.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Quality of fit = 65.4% </span></span>
<span><span class="co">#&gt; Axis predictivity:</span></span>
<span><span class="co">#&gt; Population     Income Illiteracy   Life Exp     Murder    HS Grad      Frost </span></span>
<span><span class="co">#&gt;  0.3330216  0.7609185  0.7917091  0.6206172  0.8640485  0.7947530  0.4982299 </span></span>
<span><span class="co">#&gt;       Area </span></span>
<span><span class="co">#&gt;  0.5675169</span></span></code></pre></div>
<p>The axis predictivities and sample predictivities can be represented
in the biplot in two ways: setting either <code>axis.predictivity</code>
and / or <code>sample.predictivity</code> to <code>TRUE</code>, applies
shading for axes and shrinking for samples according to the predictivity
values.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/biplot.html">biplot</a></span><span class="op">(</span><span class="va">state.x77</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/PCA.html">PCA</a></span><span class="op">(</span>group.aes <span class="op">=</span> <span class="va">state.region</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/samples.html">samples</a></span> <span class="op">(</span>which <span class="op">=</span> <span class="st">"South"</span>, pch <span class="op">=</span> <span class="fl">15</span>, label <span class="op">=</span> <span class="cn">T</span>, label.cex<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/axes.html">axes</a></span> <span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/fit.measures.html">fit.measures</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span> <span class="op">(</span>sample.predictivity <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                          axis.predictivity <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
<p><img src="biplotEZ_files/figure-html/unnamed-chunk-31-1.png" width="672"></p>
<p>Comparing the plot with the <code>summary</code> output it is clear
that the variables Population and Frost are not very well represented
and it can be expected that predictions on these variables will be less
accurate. Furthermore, the samples located close to the origin are not
as well represented as those located towards the bottom right. This is
typically the case where samples nearly orthogonal to the PCA plane are
projected close to the origin and due to their orthogonality, very
poorly represented.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-EckartYoung1936" class="csl-entry">
Eckart, C., and G. Young. 1936. <span>“The Approximation of One Matrix
by Another of Lower Rank.”</span> <em>Psychometrika</em>, 211–18.
</div>
<div id="ref-Gabriel1971" class="csl-entry">
Gabriel, K. R. 1971. <span>“The Biplot Graphic Display of Matrices with
Application to Principal Component Analysis.”</span>
<em>Biometrika</em>, 453–67.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sugnet Lubbe, Niël le Roux, Johané Nienkemper-Swanepoel, Raeesa Ganey, Ruan Buys, Zoë-Mae Adams, Peter Manefeldt.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
